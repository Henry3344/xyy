<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Survival English Guide v18.0</title>
    <style>
        /* --- CSS å˜é‡ --- */
        :root {
            --bg-body: #f2f2f7;
            --bg-card: #ffffff;
            --text-main: #1c1c1e;
            --text-sub: #636366;
            --primary: #007aff;
            --primary-light: #e5f1ff;
            --border: #c6c6c8;
            --chip-bg: #ffffff;
            --chip-border: #d1d1d6;
            --nav-bg: rgba(255,255,255,0.95);
            --shadow: rgba(0,0,0,0.06);
            --display-area: #f2f2f7;
            --danger: #ff3b30;
            --accent: #5856d6;
            --header-height: 140px; /* å®šä¹‰é¡¶éƒ¨é«˜åº¦ä»¥ä¾¿è®¡ç®— */
        }

        [data-theme="dark"] {
            --bg-body: #000000;
            --bg-card: #1c1c1e;
            --text-main: #ffffff;
            --text-sub: #aeaeb2;
            --primary: #0a84ff;
            --primary-light: #1c1c1e;
            --border: #38383a;
            --chip-bg: #2c2c2e;
            --chip-border: #3a3a3c;
            --nav-bg: rgba(28,28,30,0.95);
            --shadow: rgba(255,255,255,0.05);
            --display-area: #2c2c2e;
            --danger: #ff453a;
            --accent: #5e5ce6;
        }

        /* --- åŸºç¡€å¸ƒå±€ --- */
        html { scroll-behavior: smooth; overflow-x: hidden; width: 100%; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: var(--bg-body); 
            color: var(--text-main); 
            max-width: 650px; 
            margin: 0 auto; 
            padding: 20px; 
            padding-top: var(--header-height); 
            padding-bottom: 120px; 
            transition: background 0.3s, color 0.3s; 
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
            position: relative;
        }
        
        /* --- é¡¶éƒ¨æ§åˆ¶å° --- */
        .header-container { position: fixed; top: 0; left: 0; width: 100%; background: var(--nav-bg); backdrop-filter: blur(15px); z-index: 1000; border-bottom: 1px solid var(--border); box-shadow: 0 4px 15px var(--shadow); transition: background 0.3s; }
        
        .top-row { display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; max-width: 650px; margin: 0 auto; }
        .app-title { font-size: 1.1em; font-weight: 800; color: var(--text-main); margin: 0; }
        .header-actions { display: flex; gap: 12px; }
        .icon-btn { background: none; border: 1px solid var(--border); color: var(--text-main); width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 1.1em; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .icon-btn.danger { border-color: var(--danger); color: var(--danger); font-weight: bold; }
        
        .search-row { padding: 0 15px 10px 15px; max-width: 650px; margin: 0 auto; }
        .search-input { width: 100%; padding: 10px 15px; border-radius: 12px; border: 1px solid var(--border); background: var(--bg-body); color: var(--text-main); font-size: 1em; box-sizing: border-box; outline: none; transition: border 0.2s; }
        .search-input:focus { border-color: var(--primary); }

        .nav-scroll { display: flex; overflow-x: auto; padding: 0 15px 12px 15px; gap: 8px; max-width: 650px; margin: 0 auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
        .nav-scroll::-webkit-scrollbar { display: none; }
        .nav-btn { flex: 0 0 auto; background: var(--primary-light); color: var(--primary); border: 1px solid transparent; padding: 6px 12px; border-radius: 16px; font-weight: 600; font-size: 0.85em; text-decoration: none; transition: all 0.2s; white-space: nowrap; }
        [data-theme="dark"] .nav-btn { border-color: var(--border); }
        .nav-btn:hover, .nav-btn:active { background: var(--primary); color: white; }

        /* --- å•å…ƒå¡ç‰‡ --- */
        .unit-card { 
            background: var(--bg-card); 
            border-radius: 20px; 
            padding: 25px; 
            margin-bottom: 30px; 
            box-shadow: 0 4px 15px var(--shadow); 
            /* scroll-margin-top é…åˆCSSè·³è½¬ï¼Œä½†åœ¨JSä¸­æˆ‘ä»¬ä¼šæ‰‹åŠ¨è®¡ç®—ä»¥ç¡®ä¿ç²¾å‡† */
            scroll-margin-top: 160px; 
            border: 1px solid var(--border); 
            transition: transform 0.2s; 
        }
        .unit-header { font-size: 1.4em; font-weight: 800; color: var(--primary); margin-bottom: 20px; border-bottom: 2px solid var(--display-area); padding-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        
        .sort-rank { font-size: 0.6em; color: var(--text-sub); font-weight: normal; opacity: 0.5; background: var(--display-area); padding: 2px 6px; border-radius: 4px; }

        /* --- æ­¥éª¤åŒºåŸŸ --- */
        .step-container { margin-bottom: 25px; }
        .step-label { font-size: 0.75em; color: var(--text-sub); font-weight: 700; margin-bottom: 8px; display: block; text-transform: uppercase; letter-spacing: 0.5px; }
        .pattern-box { font-family: "Menlo", monospace; color: #d63031; background: #ffeaea; padding: 3px 6px; border-radius: 4px; font-size: 1.1em; margin-left: 5px; border: 1px solid #ffcccc; display: inline-block; margin-top: 4px; transition: opacity 0.3s; }
        [data-theme="dark"] .pattern-box { background: #3e1a1a; border-color: #5c1e1e; color: #ff6b6b; }

        /* --- ä¸»å¥æ˜¾ç¤ºåŒº --- */
        .display-area { background-color: var(--display-area); padding: 18px; border-radius: 16px; margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between; gap: 15px; transition: background 0.3s; border: 1px solid var(--border); }
        .text-content { flex-grow: 1; }
        .english-sentence { font-size: 1.3em; font-weight: 600; line-height: 1.4; color: var(--text-main); margin-bottom: 5px; transition: all 0.3s ease; }
        .highlight { color: var(--primary); text-decoration: underline; text-decoration-thickness: 3px; text-underline-offset: 4px; cursor: pointer; }
        .translation { color: var(--text-sub); font-size: 0.95em; }
        
        /* --- æŒ‰é’®é€šç”¨ --- */
        .btn-audio { background: var(--bg-card); border: 1px solid var(--border); border-radius: 50%; width: 42px; height: 42px; min-width: 42px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.2em; transition: transform 0.1s; box-shadow: 0 2px 5px var(--shadow); color: var(--primary); }
        .btn-audio:active { transform: scale(0.92); }
        
        /* --- è¯æ±‡ç‚¹å‡»åŒº --- */
        .chips-container { display: flex; flex-wrap: wrap; gap: 10px; }
        .chip { background: var(--chip-bg); border: 1px solid var(--chip-border); padding: 10px 16px; border-radius: 20px; font-size: 0.9em; cursor: pointer; font-weight: 600; color: var(--text-main); transition: all 0.2s; user-select: none; }
        .chip:hover { transform: translateY(-1px); border-color: var(--primary); }
        .chip.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 4px 10px rgba(0,122,255,0.3); transform: scale(1.02); }
        
        .add-btn-wrapper { position: relative; display: inline-block; }
        .add-chip-btn { border: 1px dashed var(--text-sub); color: var(--text-sub); background: transparent; padding: 10px 14px; }
        
        /* æ°”æ³¡æç¤º (è°ƒæ•´ä½ç½®åˆ°ä¸‹æ–¹ï¼Œé¿å…é®æŒ¡) */
        .bubble-tip { 
            position: absolute; top: 125%; left: 50%; transform: translateX(-50%); 
            background: var(--danger); color: white; padding: 8px 12px; border-radius: 12px; 
            font-size: 0.75em; font-weight: bold; box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3); 
            animation: bounce 1.5s infinite; z-index: 10; pointer-events: none;
            width: 140px; white-space: normal; text-align: center; line-height: 1.3;
            opacity: 0.9;
        }
        /* æ°”æ³¡ç®­å¤´å‘ä¸Š */
        .bubble-tip::after { content: ''; position: absolute; bottom: 100%; left: 50%; margin-left: -6px; border-width: 6px; border-style: solid; border-color: transparent transparent var(--danger) transparent; }
        @keyframes bounce { 0%, 100% { transform: translateX(-50%) translateY(0); } 50% { transform: translateX(-50%) translateY(6px); } }

        /* --- è¿æ‹›æ€»ç»“ (Combo) --- */
        .combo-box { background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white; padding: 20px; border-radius: 16px; margin-top: 25px; position: relative; box-shadow: 0 8px 15px rgba(0,0,0,0.2); }
        [data-theme="dark"] .combo-box { background: linear-gradient(135deg, #1c1c1e 0%, #2c2c2e 100%); border: 1px solid #38383a; }
        .combo-title { font-size: 0.8em; font-weight: bold; opacity: 0.8; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; color: #ecf0f1; }
        .combo-text { font-size: 1.1em; font-weight: 600; line-height: 1.5; padding-right: 45px; margin-bottom: 12px; transition: all 0.3s; }
        .structure-box { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 8px; font-size: 0.85em; color: #bdc3c7; border: 1px dashed rgba(255,255,255,0.3); transition: all 0.3s; }
        .struct-tag { display: inline-block; background: #e67e22; color: white; padding: 1px 5px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; font-weight: bold; }
        .struct-arrow { margin: 0 4px; color: #ecf0f1; }
        .combo-audio-btn { position: absolute; top: 15px; right: 15px; background: #27ae60; border: none; color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.2em; box-shadow: 0 4px 8px rgba(39, 174, 96, 0.4); }
        
        /* --- æ‚¬æµ®æ§åˆ¶ç»„ --- */
        .float-controls { position: fixed; bottom: 30px; right: 20px; display: flex; flex-direction: column; gap: 12px; z-index: 2000; align-items: flex-end; }
        .scroll-btn { width: 44px; height: 44px; background: var(--bg-card); border: 1px solid var(--border); color: var(--text-main); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; box-shadow: 0 4px 12px var(--shadow); cursor: pointer; transition: transform 0.2s; opacity: 0.9; }
        .scroll-btn:active { transform: scale(0.9); }

        .fab-quiz { background: var(--danger); color: white; padding: 12px 20px; border-radius: 30px; font-weight: bold; box-shadow: 0 4px 15px rgba(255, 59, 48, 0.4); cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px; border: none; }
        .fab-quiz:active { transform: scale(0.95); }
        .quiz-active-text { display: none; }
        body.quiz-mode .fab-quiz { background: #34c759; box-shadow: 0 4px 15px rgba(52, 199, 89, 0.4); }
        body.quiz-mode .quiz-default-text { display: none; }
        body.quiz-mode .quiz-active-text { display: inline; }

        .fab-random { background: var(--accent); color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5em; box-shadow: 0 4px 15px rgba(88, 86, 214, 0.4); border: none; cursor: pointer; }

        /* --- ç‰¹è®­æ¨¡å¼ (Quiz Mode) --- */
        body.quiz-mode .english-sentence { color: transparent !important; text-shadow: 0 0 13px rgba(128,128,128,0.5); user-select: none; }
        body.quiz-mode .english-sentence:active { color: var(--text-main) !important; text-shadow: none; }
        body.quiz-mode .pattern-box { color: transparent !important; background-color: var(--border); border-color: var(--border); user-select: none; }
        body.quiz-mode .pattern-box:active { color: #d63031 !important; background-color: #ffeaea; }
        body.quiz-mode .combo-text { color: transparent !important; text-shadow: 0 0 10px rgba(255,255,255,0.4); user-select: none; background: rgba(255,255,255,0.1); border-radius: 4px; }
        body.quiz-mode .combo-text:active { color: white !important; text-shadow: none; background: none; }
        body.quiz-mode .structure-box { color: transparent !important; text-shadow: 0 0 8px rgba(255,255,255,0.5); user-select: none; }
        body.quiz-mode .structure-box * { opacity: 0; }
        body.quiz-mode .structure-box:active { color: #bdc3c7 !important; text-shadow: none; }
        body.quiz-mode .structure-box:active * { opacity: 1; }

        /* --- åº”æ€¥æ¨¡å¼ Overlay --- */
        .emergency-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: none; flex-direction: column; padding: 20px; box-sizing: border-box; }
        .emergency-overlay.active { display: flex; }
        .emergency-close { position: absolute; top: 20px; right: 20px; color: white; font-size: 2em; cursor: pointer; padding: 10px; }
        .emergency-card { flex: 1; display: flex; align-items: center; justify-content: center; text-align: center; border-bottom: 1px solid #333; cursor: pointer; }
        .emergency-text { font-size: 2.2em; color: white; font-weight: bold; line-height: 1.2; text-transform: uppercase; margin-bottom: 10px; }
        .emergency-sub { font-size: 1.2em; color: #aaa; }

        /* --- å¼¹çª—é€šç”¨ --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 5000; display: none; align-items: center; justify-content: center; }
        .modal-card { background: var(--bg-card); width: 85%; max-width: 400px; padding: 30px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 1px solid var(--border); animation: popIn 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .modal-title { font-size: 1.2em; font-weight: bold; color: var(--text-sub); margin-bottom: 20px; text-transform: uppercase; }
        .modal-content-text { font-size: 1.2em; color: var(--text-main); margin-bottom: 30px; line-height: 1.5; }
        .modal-actions { display: flex; gap: 10px; justify-content: center; }
        .modal-btn { padding: 10px 20px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; font-size: 1em; }
        .btn-reveal { background: var(--primary); color: white; }
        .btn-close { background: var(--border); color: var(--text-main); }

        footer { text-align: center; color: var(--text-sub); font-size: 0.8em; margin-top: 50px; padding-top: 20px; border-top: 1px solid var(--border); }
    </style>
</head>
<body>

    <div class="header-container" id="mainHeader">
        <div class="top-row">
            <div class="app-title">ğŸ‡ºğŸ‡¸ Survival English Guide</div>
            <div class="header-actions">
                <button class="icon-btn danger" onclick="toggleEmergency()" title="åº”æ€¥æ¨¡å¼">âš¡</button>
                <button class="icon-btn" onclick="toggleTheme()" title="åˆ‡æ¢æ¨¡å¼">ğŸŒ—</button>
            </div>
        </div>
        
        <div class="search-row">
            <input type="text" class="search-input" id="searchBox" placeholder="ğŸ” æœç´¢åœºæ™¯ (å¦‚: é€€è´§, coffee...)" onkeyup="filterUnits()">
        </div>

        <div class="nav-scroll">
            <a href="#u1" class="nav-btn">é‚»å±…</a>
            <a href="#u2" class="nav-btn">ä½ç½®</a>
            <a href="#u3" class="nav-btn">æ´—æ‰‹é—´</a>
            <a href="#u4" class="nav-btn">é“¶è¡Œ</a>
            <a href="#u5" class="nav-btn">ç»“è´¦</a>
            <a href="#u6" class="nav-btn">ç‚¹é¤</a>
            <a href="#u7" class="nav-btn">èšé¤</a>
            <a href="#u8" class="nav-btn">å™æ—§</a>
            <a href="#u9" class="nav-btn">æ‰“è½¦</a>
            <a href="#u10" class="nav-btn">æ€¥æ•‘</a>
            <a href="#u11" class="nav-btn">æ²¡å¬æ‡‚</a>
            <a href="#u12" class="nav-btn">é€€è´§</a>
            <a href="#u13" class="nav-btn">é¢„çº¦</a>
        </div>
    </div>

    <div class="emergency-overlay" id="emergencyOverlay">
        <div class="emergency-close" onclick="toggleEmergency()">âœ•</div>
        <div class="emergency-card" onclick="speakDirect('I need help! Please call 911.')">
            <div>
                <div class="emergency-text" style="color: #ff3b30;">I NEED HELP!<br>CALL 911</div>
                <div class="emergency-sub">æ•‘å‘½ï¼è¯·æ‰“911</div>
            </div>
        </div>
        <div class="emergency-card" onclick="speakDirect('I do not speak English. Please use a translation app.')">
            <div>
                <div class="emergency-text">I DON'T SPEAK ENGLISH</div>
                <div class="emergency-sub">æˆ‘ä¸ä¼šè‹±è¯­ (è¯·ç”¨ç¿»è¯‘è½¯ä»¶)</div>
            </div>
        </div>
        <div class="emergency-card" onclick="speakDirect('I am lost. Can you help me?')">
            <div>
                <div class="emergency-text">I AM LOST<br>CAN YOU HELP?</div>
                <div class="emergency-sub">æˆ‘è¿·è·¯äº†ï¼Œèƒ½å¸®æˆ‘å—ï¼Ÿ</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="randomModal">
        <div class="modal-card">
            <div class="modal-title">ğŸ² éšæœºåœºæ™¯æŒ‘æˆ˜</div>
            <div class="modal-content-text" id="modalQuestion" style="font-weight:bold; font-size: 1.4em;">...</div>
            <div class="modal-actions">
                <button class="modal-btn btn-close" onclick="closeModal('randomModal')">å…³é—­</button>
                <button class="modal-btn btn-reveal" onclick="revealRandomAnswer()">æŸ¥çœ‹ç­”æ¡ˆ</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="reportModal">
        <div class="modal-card">
            <div class="modal-title">ğŸ“… æœˆåº¦æš–å¿ƒå°ç»“</div>
            <div class="modal-content-text" id="reportContent" style="text-align: left; font-size: 1em;">...</div>
            <div class="modal-actions">
                <button class="modal-btn btn-reveal" onclick="closeModal('reportModal')">ç»§ç»­åŠ æ²¹ï¼</button>
            </div>
        </div>
    </div>

    <div class="float-controls">
        <button class="scroll-btn" onclick="window.scrollTo(0,0)" title="å›åˆ°é¡¶éƒ¨">â¬†ï¸</button>
        <button class="fab-random" onclick="startRandomDrill()" title="éšæœºæŠ½æŸ¥">ğŸ²</button>
        <button class="fab-quiz" onclick="toggleQuizMode()">
            <span class="quiz-default-text">ğŸ‘ï¸ é®æŒ¡ç‰¹è®­</span>
            <span class="quiz-active-text">âœ… æ¢å¤æ˜¾ç¤º</span>
        </button>
        <button class="scroll-btn" onclick="window.scrollTo(0, document.body.scrollHeight)" title="å»åˆ°åº•éƒ¨">â¬‡ï¸</button>
    </div>

    <div id="content-area">
        <div class="unit-card" id="u1" data-name="é‚»å±…æ‰“æ‹›å‘¼" data-keywords="é‚»å±… æ‰“æ‹›å‘¼ ä»‹ç» neighbor">
            <div class="unit-header">
                é‚»å±…æ‰“æ‹›å‘¼
                <span class="sort-rank"></span>
            </div>
            <div class="step-container">
                <span class="step-label">Step 1: ä»‹ç» <span class="pattern-box">Hi, I'm ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Hi, I'm <span class="highlight" id="u1-s1-word">your new neighbor</span>.</div>
                        <div class="translation" id="u1-s1-trans">å—¨ï¼Œæˆ‘æ˜¯ä½ çš„æ–°é‚»å±…ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u1-s1-word', 'Hi, I am', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u1-s1-chips">
                    <div class="chip active" onclick="updateUnit(1, 1, 'your new neighbor', 'ä½ çš„æ–°é‚»å±…', 'Hi, I am', '', this)">your new neighbor</div>
                    <div class="chip" onclick="updateUnit(1, 1, 'David', 'David', 'Hi, I am', '', this)">David</div>
                    <div class="chip" onclick="updateUnit(1, 1, 'moving in', 'åˆšæ¬è¿›æ¥', 'Hi, I am', '', this)">moving in</div>
                    <div class="chip" onclick="updateUnit(1, 1, 'visiting my aunt', 'æ¥çœ‹æˆ‘é˜¿å§¨çš„', 'Hi, I am', '', this)">visiting my aunt</div>
                    <div class="add-btn-wrapper">
                        <div class="bubble-tip">æ²¡æœ‰ä½ æƒ³è¦çš„ï¼Ÿè¿™é‡Œå¯ä»¥è‡ªå·±æ·»åŠ å¹¶ä¸”ä¹Ÿå¯ä»¥å‘éŸ³å“¦ï¼</div>
                        <button class="chip add-chip-btn" onclick="addCustomChip(1, 1, 'Hi, I am', '')">ï¼‹</button>
                    </div>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: ä½å€ <span class="pattern-box">I live in ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">I live in <span class="highlight" id="u1-s2-word">Apt 302</span>.</div>
                        <div class="translation" id="u1-s2-trans">æˆ‘ä½åœ¨302å®¤ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u1-s2-word', 'I live in', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u1-s2-chips">
                    <div class="chip active" onclick="updateUnit(1, 2, 'Apt 302', '302å®¤', 'I live in', '', this)">Apt 302</div>
                    <div class="chip" onclick="updateUnit(1, 2, 'next door', 'éš”å£', 'I live', '', this)">next door</div>
                    <div class="chip" onclick="updateUnit(1, 2, 'downstairs', 'æ¥¼ä¸‹', 'I live', '', this)">downstairs</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(1, 2, 'I live in', '')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hi, I'm your new neighbor. I live in Apt 302, nice to meet you."</div>
                <div class="structure-box"><span class="struct-tag">æˆ‘æ˜¯è°</span> I'm [Name] <span class="struct-arrow">âœ</span> <span class="struct-tag">ä½å“ªé‡Œ</span> I live in [Location].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hi, I am your new neighbor. I live in Apt 302, nice to meet you.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u2" data-name="è¯¢é—®ä½ç½®" data-keywords="ä½ç½® æ‰¾è·¯ é—®è·¯ location looking for">
            <div class="unit-header">è¯¢é—®ä½ç½®</div>
            <div class="step-container">
                <span class="step-label">Step 1: ç›®çš„ <span class="pattern-box">I'm looking for ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Excuse me, I'm looking for <span class="highlight" id="u2-s1-word">Unit 5B</span>.</div>
                        <div class="translation" id="u2-s1-trans">æ‰“æ‰°ä¸€ä¸‹ï¼Œæˆ‘åœ¨æ‰¾5Bå•å…ƒã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u2-s1-word', 'Excuse me, I am looking for', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u2-s1-chips">
                    <div class="chip active" onclick="updateUnit(2, 1, 'Unit 5B', '5Bå•å…ƒ', 'Excuse me, I am looking for', '', this)">Unit 5B</div>
                    <div class="chip" onclick="updateUnit(2, 1, 'the exit', 'å‡ºå£', 'Excuse me, I am looking for', '', this)">the exit</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(2, 1, 'Excuse me, I am looking for', '')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: æé—® <span class="pattern-box">Could you tell me ... ?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Could you tell me <span class="highlight" id="u2-s2-word">how to get there</span>?</div>
                        <div class="translation" id="u2-s2-trans">èƒ½å‘Šè¯‰æˆ‘æ€ä¹ˆèµ°å—ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u2-s2-word', 'Could you tell me', '?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u2-s2-chips">
                    <div class="chip active" onclick="updateUnit(2, 2, 'how to get there', 'æ€ä¹ˆèµ°', 'Could you tell me', 'å—', this)">how to get there</div>
                    <div class="chip" onclick="updateUnit(2, 2, 'where it is', 'å®ƒåœ¨å“ª', 'Could you tell me', 'å—', this)">where it is</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(2, 2, 'Could you tell me', '?')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Excuse me, I'm looking for the exit. Could you tell me how to get there?"</div>
                <div class="structure-box"><span class="struct-tag">è¦æ‰¾å•¥</span> Looking for [Target] <span class="struct-arrow">âœ</span> <span class="struct-tag">é—®è·¯</span> Tell me [Way].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Excuse me, I am looking for the exit. Could you tell me how to get there?')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u3" data-name="å€Ÿç”¨æ´—æ‰‹é—´" data-keywords="æ´—æ‰‹é—´ å•æ‰€ ç´§æ€¥ restroom urgent">
            <div class="unit-header">å€Ÿç”¨æ´—æ‰‹é—´</div>
            <div class="step-container">
                <span class="step-label">Step 1: ç¤¼è²Œè¯·æ±‚ <span class="pattern-box">Could I use ... ?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Could I use your <span class="highlight" id="u3-s1-word">restroom</span>?</div>
                        <div class="translation" id="u3-s1-trans">æˆ‘èƒ½å€Ÿç”¨ä¸€ä¸‹æ‚¨çš„æ´—æ‰‹é—´å—ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u3-s1-word', 'Could I use your', '?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u3-s1-chips">
                    <div class="chip active" onclick="updateUnit(3, 1, 'restroom', 'æ´—æ‰‹é—´', 'Could I use your', 'å—', this)">restroom</div>
                    <div class="chip" onclick="updateUnit(3, 1, 'charger', 'å……ç”µå™¨', 'Could I use your', 'å—', this)">charger</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(3, 1, 'Could I use your', '?')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: è¡¥å……è¯´æ˜ <span class="pattern-box">It's really ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">It's really <span class="highlight" id="u3-s2-word">urgent</span>.</div>
                        <div class="translation" id="u3-s2-trans">çœŸçš„å¾ˆç´§æ€¥ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u3-s2-word', 'It is really', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u3-s2-chips">
                    <div class="chip active" onclick="updateUnit(3, 2, 'urgent', 'ç´§æ€¥', 'It is really', '', this)">urgent</div>
                    <div class="chip" onclick="updateUnit(3, 2, 'quick', 'å¿«(å¾ˆå¿«å°±å¥½)', 'It will be really', '', this)">quick</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(3, 2, 'It is really', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Sorry to bother you, could I use your restroom? It's really urgent."</div>
                <div class="structure-box"><span class="struct-tag">è¯·æ±‚</span> Could I use [Item]? <span class="struct-arrow">âœ</span> <span class="struct-tag">å¼ºè°ƒ</span> It's [Urgency].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Sorry to bother you, could I use your restroom? It is really urgent.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u4" data-name="é“¶è¡ŒåŠäº‹" data-keywords="é“¶è¡Œ å­˜é’± å–é’± bank deposit">
            <div class="unit-header">é“¶è¡ŒåŠäº‹</div>
            <div class="step-container">
                <span class="step-label">Step 1: æ„å›¾ <span class="pattern-box">I'd like to ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">I'd like to <span class="highlight" id="u4-s1-word">deposit money</span>.</div>
                        <div class="translation" id="u4-s1-trans">æˆ‘æƒ³è¦å­˜é’±ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u4-s1-word', 'I would like to', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u4-s1-chips">
                    <div class="chip active" onclick="updateUnit(4, 1, 'deposit money', 'å­˜é’±', 'I would like to', '', this)">deposit money</div>
                    <div class="chip" onclick="updateUnit(4, 1, 'withdraw cash', 'å–ç°', 'I would like to', '', this)">withdraw cash</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(4, 1, 'I would like to', '.')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: åŠ¨ä½œ <span class="pattern-box">Here is my ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Here is my <span class="highlight" id="u4-s2-word">debit card</span>.</div>
                        <div class="translation" id="u4-s2-trans">è¿™æ˜¯æˆ‘çš„å€Ÿè®°å¡ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u4-s2-word', 'Here is my', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u4-s2-chips">
                    <div class="chip active" onclick="updateUnit(4, 2, 'debit card', 'å€Ÿè®°å¡', 'Here is my', '', this)">debit card</div>
                    <div class="chip" onclick="updateUnit(4, 2, 'ID', 'è¯ä»¶', 'Here is my', '', this)">ID</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(4, 2, 'Here is my', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hi, I'd like to deposit money. Here is my debit card."</div>
                <div class="structure-box"><span class="struct-tag">åŠäº‹</span> I'd like to [Action] <span class="struct-arrow">âœ</span> <span class="struct-tag">ç»™å¡</span> Here is [Item].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hi, I would like to deposit money. Here is my debit card.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u5" data-name="è¶…å¸‚ç»“è´¦" data-keywords="è¶…å¸‚ ç»“è´¦ æ”¯ä»˜ checkout pay">
            <div class="unit-header">è¶…å¸‚ç»“è´¦</div>
            <div class="step-container">
                <span class="step-label">Step 1: æ”¯ä»˜ <span class="pattern-box">Do you accept ... ?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Do you accept <span class="highlight" id="u5-s1-word">Apple Pay</span>?</div>
                        <div class="translation" id="u5-s1-trans">ä½ ä»¬æ”¶Apple Payå—ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u5-s1-word', 'Do you accept', '?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u5-s1-chips">
                    <div class="chip active" onclick="updateUnit(5, 1, 'Apple Pay', 'Apple Pay', 'Do you accept', 'å—', this)">Apple Pay</div>
                    <div class="chip" onclick="updateUnit(5, 1, 'credit cards', 'ä¿¡ç”¨å¡', 'Do you accept', 'å—', this)">credit cards</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(5, 1, 'Do you accept', '?')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: éœ€æ±‚ <span class="pattern-box">I also need ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">I also need <span class="highlight" id="u5-s2-word">a bag</span>.</div>
                        <div class="translation" id="u5-s2-trans">æˆ‘è¿˜æƒ³è¦ä¸ªè¢‹å­ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u5-s2-word', 'I also need', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u5-s2-chips">
                    <div class="chip active" onclick="updateUnit(5, 2, 'a bag', 'ä¸ªè¢‹å­', 'I also need', '', this)">a bag</div>
                    <div class="chip" onclick="updateUnit(5, 2, 'a receipt', 'ä¸ªæ”¶æ®', 'I also need', '', this)">a receipt</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(5, 2, 'I also need', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Do you accept Apple Pay? I also need a bag, please."</div>
                <div class="structure-box"><span class="struct-tag">ä»˜é’±</span> Do you accept [Method]? <span class="struct-arrow">âœ</span> <span class="struct-tag">è¦è¢‹å­</span> I also need [Item].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Do you accept Apple Pay? I also need a bag, please.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u6" data-name="é¤å…ç‚¹é¤" data-keywords="ç‚¹é¤ å’–å•¡ é¤å… ordering coffee">
            <div class="unit-header">é¤å…ç‚¹é¤</div>
            <div class="step-container">
                <span class="step-label">Step 1: ä¸‹å• <span class="pattern-box">Can I get a ... ?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Can I get a <span class="highlight" id="u6-s1-word">hot coffee</span>?</div>
                        <div class="translation" id="u6-s1-trans">æˆ‘èƒ½è¦ä¸€æ¯çƒ­å’–å•¡å—ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u6-s1-word', 'Can I get a', '?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u6-s1-chips">
                    <div class="chip active" onclick="updateUnit(6, 1, 'hot coffee', 'çƒ­å’–å•¡', 'Can I get a', 'å—', this)">hot coffee</div>
                    <div class="chip" onclick="updateUnit(6, 1, 'bagel', 'è´æœé¢åŒ…', 'Can I get a', 'å—', this)">bagel</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(6, 1, 'Can I get a', '?')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: åå¥½ <span class="pattern-box">Make it ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Make it <span class="highlight" id="u6-s2-word">large size</span>.</div>
                        <div class="translation" id="u6-s2-trans">è¦åšæˆå¤§æ¯çš„ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u6-s2-word', 'Make it', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u6-s2-chips">
                    <div class="chip active" onclick="updateUnit(6, 2, 'large size', 'å¤§æ¯/å¤§ä»½', 'Make it', '', this)">large size</div>
                    <div class="chip" onclick="updateUnit(6, 2, 'iced', 'å†°çš„', 'Make it', '', this)">iced</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(6, 2, 'Make it', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hi, can I get a hot coffee? Make it large size, please."</div>
                <div class="structure-box"><span class="struct-tag">è¦å•¥</span> Can I get [Food] <span class="struct-arrow">âœ</span> <span class="struct-tag">å’‹åƒ</span> Make it [Size/Style].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hi, can I get a hot coffee? Make it large size, please.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u7" data-name="äº²å‹èšé¤" data-keywords="èšé¤ åƒé¥­ å¥½åƒ tasty">
            <div class="unit-header">äº²å‹èšé¤</div>
            <div class="step-container">
                <span class="step-label">Step 1: å¤¸èµé£Ÿç‰© <span class="pattern-box">This ... is amazing!</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">This <span class="highlight" id="u7-s1-word">soup</span> is amazing!</div>
                        <div class="translation" id="u7-s1-trans">è¿™æ±¤å¤ªæ£’äº†ï¼</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u7-s1-word', 'This', 'is amazing!')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u7-s1-chips">
                    <div class="chip active" onclick="updateUnit(7, 1, 'soup', 'æ±¤', 'This', 'is amazing!', this)">soup</div>
                    <div class="chip" onclick="updateUnit(7, 1, 'steak', 'ç‰›æ’', 'This', 'is amazing!', this)">steak</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(7, 1, 'This', 'is amazing!')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: ä¸»åŠ¨å¸®å¿™ <span class="pattern-box">Let me help ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Let me help <span class="highlight" id="u7-s2-word">clean up</span>.</div>
                        <div class="translation" id="u7-s2-trans">æˆ‘æ¥å¸®å¿™æ”¶æ‹¾ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u7-s2-word', 'Let me help', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u7-s2-chips">
                    <div class="chip active" onclick="updateUnit(7, 2, 'clean up', 'æ”¶æ‹¾', 'Let me help', '', this)">clean up</div>
                    <div class="chip" onclick="updateUnit(7, 2, 'wash dishes', 'æ´—ç¢—', 'Let me help', '', this)">wash dishes</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(7, 2, 'Let me help', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Wow, this soup is amazing! Let me help clean up."</div>
                <div class="structure-box"><span class="struct-tag">å¤¸äºº</span> This [Food] is amazing <span class="struct-arrow">âœ</span> <span class="struct-tag">å¸®å¿™</span> Let me help [Action].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Wow, this soup is amazing! Let me help clean up.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u8" data-name="ç”µè¯å™æ—§" data-keywords="ç”µè¯ å™æ—§ æœ‹å‹ call friend">
            <div class="unit-header">ç”µè¯å™æ—§</div>
            <div class="step-container">
                <span class="step-label">Step 1: å¼€åœº <span class="pattern-box">It's been a while since ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">It's been a while since <span class="highlight" id="u8-s1-word">we talked</span>.</div>
                        <div class="translation" id="u8-s1-trans">æˆ‘ä»¬å¥½ä¹…æ²¡èŠå¤©äº†ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u8-s1-word', 'It has been a while since', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u8-s1-chips">
                    <div class="chip active" onclick="updateUnit(8, 1, 'we talked', 'èŠå¤©', 'It has been a while since', '', this)">we talked</div>
                    <div class="chip" onclick="updateUnit(8, 1, 'we met', 'è§é¢', 'It has been a while since', '', this)">we met</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(8, 1, 'It has been a while since', '.')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: è¯¢é—® <span class="pattern-box">How have you ... ?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">How have you <span class="highlight" id="u8-s2-word">been</span>?</div>
                        <div class="translation" id="u8-s2-trans">ä½ æœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u8-s2-word', 'How have you', '?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u8-s2-chips">
                    <div class="chip active" onclick="updateUnit(8, 2, 'been', 'è¿‡å¾—æ€æ ·', 'How have you', 'å—', this)">been</div>
                    <div class="chip" onclick="updateUnit(8, 2, 'been doing', 'åœ¨å¿™ä»€ä¹ˆ', 'How have you', 'å—', this)">been doing</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(8, 2, 'How have you', '?')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hey! It's been a while since we met. How have you been?"</div>
                <div class="structure-box"><span class="struct-tag">å¥½ä¹…ä¸è§</span> It's been a while <span class="struct-arrow">âœ</span> <span class="struct-tag">è¿‘å†µå¦‚ä½•</span> How have you been?</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hey! It has been a while since we met. How have you been?')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u9" data-name="æ‰“è½¦å‡ºè¡Œ" data-keywords="æ‰“è½¦ uber taxi ride">
            <div class="unit-header">æ‰“è½¦å‡ºè¡Œ</div>
            <div class="step-container">
                <span class="step-label">Step 1: ç›®çš„åœ° <span class="pattern-box">I'm going to ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">I'm going to <span class="highlight" id="u9-s1-word">JFK Airport</span>.</div>
                        <div class="translation" id="u9-s1-trans">æˆ‘è¦å»è‚¯å°¼è¿ªæœºåœºã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u9-s1-word', 'I am going to', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u9-s1-chips">
                    <div class="chip active" onclick="updateUnit(9, 1, 'JFK Airport', 'è‚¯å°¼è¿ªæœºåœº', 'I am going to', '', this)">JFK Airport</div>
                    <div class="chip" onclick="updateUnit(9, 1, 'Main Street', 'ç¼…è¡—', 'I am going to', '', this)">Main Street</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(9, 1, 'I am going to', '.')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: åœè½¦ä½ç½® <span class="pattern-box">Please drop me at ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Please drop me at <span class="highlight" id="u9-s2-word">the corner</span>.</div>
                        <div class="translation" id="u9-s2-trans">è¯·åœ¨è·¯å£æ”¾æˆ‘ä¸‹æ¥ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u9-s2-word', 'Please drop me at', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u9-s2-chips">
                    <div class="chip active" onclick="updateUnit(9, 2, 'the corner', 'è·¯å£', 'Please drop me at', '', this)">the corner</div>
                    <div class="chip" onclick="updateUnit(9, 2, 'the entrance', 'å…¥å£', 'Please drop me at', '', this)">the entrance</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(9, 2, 'Please drop me at', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hi, I'm going to Main Street. Please drop me at the corner."</div>
                <div class="structure-box"><span class="struct-tag">å»å“ª</span> I'm going to [Place] <span class="struct-arrow">âœ</span> <span class="struct-tag">å“ªåœ</span> Drop me at [Spot].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hi, I am going to Main Street. Please drop me at the corner.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u10" data-name="ç´§æ€¥æ±‚åŠ©" data-keywords="æ€¥æ•‘ æŠ¥è­¦ fire help 911">
            <div class="unit-header">ç´§æ€¥æ±‚åŠ©</div>
            <div class="step-container">
                <span class="step-label">Step 1: çŠ¶å†µ <span class="pattern-box">There is ... !</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">There is <span class="highlight" id="u10-s1-word">a fire</span>!</div>
                        <div class="translation" id="u10-s1-trans">ç€ç«äº†ï¼</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u10-s1-word', 'There is', '!')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u10-s1-chips">
                    <div class="chip active" onclick="updateUnit(10, 1, 'a fire', 'ç«ç¾', 'There is', '!', this)">a fire</div>
                    <div class="chip" onclick="updateUnit(10, 1, 'an accident', 'äº‹æ•…', 'There is', '!', this)">an accident</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(10, 1, 'There is', '!')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: å‘¼å« <span class="pattern-box">Call ... !</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Call <span class="highlight" id="u10-s2-word">911</span>!</div>
                        <div class="translation" id="u10-s2-trans">æ‰“911ï¼</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u10-s2-word', 'Call', 'now!')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u10-s2-chips">
                    <div class="chip active" onclick="updateUnit(10, 2, '911', '911', 'Call', '!', this)">911</div>
                    <div class="chip" onclick="updateUnit(10, 2, 'the police', 'è­¦å¯Ÿ', 'Call', '!', this)">the police</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(10, 2, 'Call', '!')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Help! There is an accident! Call 911 now!"</div>
                <div class="structure-box"><span class="struct-tag">å‡ºäº‹äº†</span> There is [Event]! <span class="struct-arrow">âœ</span> <span class="struct-tag">å–Šäºº</span> Call [Who]!</div>
                <button class="combo-audio-btn" onclick="speakDirect('Help! There is an accident! Call 911 now!')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u11" data-name="æ²¡å¬æ‡‚" data-keywords="å¬ä¸æ‡‚ é‡å¤ repeat clarify">
            <div class="unit-header">æ²¡å¬æ‡‚/æ±‚é‡å¤</div>
            <div class="step-container">
                <span class="step-label">Step 1: è¡¨ç¤ºæŠ±æ­‰ <span class="pattern-box">Sorry, I didn't ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Sorry, I didn't <span class="highlight" id="u11-s1-word">catch that</span>.</div>
                        <div class="translation" id="u11-s1-trans">æŠ±æ­‰ï¼Œæˆ‘æ²¡å¬æ¸…ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u11-s1-word', 'Sorry, I did not', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u11-s1-chips">
                    <div class="chip active" onclick="updateUnit(11, 1, 'catch that', 'å¬æ¸…', 'Sorry, I did not', '', this)">catch that</div>
                    <div class="chip" onclick="updateUnit(11, 1, 'understand', 'å¬æ‡‚', 'Sorry, I did not', '', this)">understand</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(11, 1, 'Sorry, I did not', '.')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: æå‡ºè¯·æ±‚ <span class="pattern-box">Could you ... ?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Could you <span class="highlight" id="u11-s2-word">say that again</span>?</div>
                        <div class="translation" id="u11-s2-trans">ä½ èƒ½å†è¯´ä¸€éå—ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u11-s2-word', 'Could you', '?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u11-s2-chips">
                    <div class="chip active" onclick="updateUnit(11, 2, 'say that again', 'å†è¯´ä¸€é', 'Could you', 'å—', this)">say that again</div>
                    <div class="chip" onclick="updateUnit(11, 2, 'speak slower', 'è¯´æ…¢ç‚¹', 'Could you', 'å—', this)">speak slower</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(11, 2, 'Could you', '?')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Sorry, I didn't catch that. Could you speak slower, please?"</div>
                <div class="structure-box"><span class="struct-tag">æ²¡å¬æ‡‚</span> Sorry, I didn't [Verb] <span class="struct-arrow">âœ</span> <span class="struct-tag">å’‹åŠ</span> Could you [Action]?</div>
                <button class="combo-audio-btn" onclick="speakDirect('Sorry, I did not catch that. Could you speak slower, please?')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u12" data-name="é€€è´§/æ¢è´§" data-keywords="é€€è´§ æ¢è´§ return exchange">
            <div class="unit-header">é€€è´§/æ¢è´§</div>
            <div class="step-container">
                <span class="step-label">Step 1: ç›®çš„ <span class="pattern-box">I'd like to ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">I'd like to <span class="highlight" id="u12-s1-word">return this</span>.</div>
                        <div class="translation" id="u12-s1-trans">æˆ‘æƒ³è¦é€€äº†è¿™ä¸ªã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u12-s1-word', 'I would like to', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u12-s1-chips">
                    <div class="chip active" onclick="updateUnit(12, 1, 'return this', 'é€€è´§', 'I would like to', '', this)">return this</div>
                    <div class="chip" onclick="updateUnit(12, 1, 'exchange this', 'æ¢è´§', 'I would like to', '', this)">exchange this</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(12, 1, 'I would like to', '.')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: ç†ç”± <span class="pattern-box">It is ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">It is <span class="highlight" id="u12-s2-word">too small</span>.</div>
                        <div class="translation" id="u12-s2-trans">å®ƒå¤ªå°äº†ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u12-s2-word', 'It is', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u12-s2-chips">
                    <div class="chip active" onclick="updateUnit(12, 2, 'too small', 'å¤ªå°', 'It is', '', this)">too small</div>
                    <div class="chip" onclick="updateUnit(12, 2, 'broken', 'åäº†', 'It is', '', this)">broken</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(12, 2, 'It is', '.')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hi, I'd like to return this. It is broken."</div>
                <div class="structure-box"><span class="struct-tag">åŠ¨ä½œ</span> I'd like to [Return] <span class="struct-arrow">âœ</span> <span class="struct-tag">åŸå› </span> It is [Reason].</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hi, I would like to return this. It is broken.')">ğŸ”Š</button>
            </div>
        </div>

        <div class="unit-card" id="u13" data-name="ç”µè¯é¢„çº¦" data-keywords="é¢„çº¦ é¢„è®¢ appointment reservation">
            <div class="unit-header">ç”µè¯é¢„çº¦</div>
            <div class="step-container">
                <span class="step-label">Step 1: ç›®çš„ <span class="pattern-box">I'd like to make an appointment for ...</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">I'd like to make an appointment for <span class="highlight" id="u13-s1-word">a haircut</span>.</div>
                        <div class="translation" id="u13-s1-trans">æˆ‘æƒ³é¢„çº¦å‰ªå¤´å‘ã€‚</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u13-s1-word', 'I would like to make an appointment for', '.')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u13-s1-chips">
                    <div class="chip active" onclick="updateUnit(13, 1, 'a haircut', 'å‰ªå¤´å‘', 'I would like to make an appointment for', '', this)">a haircut</div>
                    <div class="chip" onclick="updateUnit(13, 1, 'a dental exam', 'çœ‹ç‰™åŒ»', 'I would like to make an appointment for', '', this)">a dental exam</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(13, 1, 'I would like to make an appointment for', '.')">ï¼‹</button>
                </div>
            </div>
            <hr class="divider">
            <div class="step-container">
                <span class="step-label">Step 2: æ—¶é—´ <span class="pattern-box">Is ... available?</span></span>
                <div class="display-area">
                    <div class="text-content">
                        <div class="english-sentence">Is <span class="highlight" id="u13-s2-word">Sunday at 5pm</span> available?</div>
                        <div class="translation" id="u13-s2-trans">å‘¨æ—¥ä¸‹åˆ5ç‚¹æœ‰ç©ºå—ï¼Ÿ</div>
                    </div>
                    <button class="btn-audio" onclick="speakWholeSentence('u13-s2-word', 'Is', 'available?')">ğŸ”Š</button>
                </div>
                <div class="chips-container" id="u13-s2-chips">
                    <div class="chip active" onclick="updateUnit(13, 2, 'Sunday at 5pm', 'å‘¨æ—¥ä¸‹åˆ5ç‚¹', 'Is', 'available', this)">Sunday at 5pm</div>
                    <div class="chip" onclick="updateUnit(13, 2, 'tomorrow morning', 'æ˜å¤©æ—©ä¸Š', 'Is', 'available', this)">tomorrow morning</div>
                    <button class="chip add-chip-btn" onclick="addCustomChip(13, 2, 'Is', 'available?')">ï¼‹</button>
                </div>
            </div>
            <div class="combo-box">
                <div class="combo-title">ğŸš€ é€»è¾‘æ„é€  (ç¤ºä¾‹é€ å¥)</div>
                <div class="combo-text">"Hi, I'd like to make an appointment for a haircut. Is tomorrow morning available?"</div>
                <div class="structure-box"><span class="struct-tag">é¢„çº¦å•¥</span> Appointment for [Event] <span class="struct-arrow">âœ</span> <span class="struct-tag">å•¥æ—¶å€™</span> Is [Time] available?</div>
                <button class="combo-audio-btn" onclick="speakDirect('Hi, I would like to make an appointment for a haircut. Is tomorrow morning available?')">ğŸ”Š</button>
            </div>
        </div>

    </div>

    <footer>
        <p>&copy; <span id="year"></span> Henry's Survival English Guide. All rights reserved.</p>
        <p style="font-size: 0.9em; opacity: 0.7;">Current Time: <span id="datetime"></span></p>
    </footer>

    <script>
        // === æ ¸å¿ƒé€»è¾‘ ===
        let usageData = {};
        let currentRandomUnit = null;

        // 1. åˆå§‹åŒ–
        window.onload = function() {
            updateTime();
            setInterval(updateTime, 1000);
            document.getElementById('year').innerText = new Date().getFullYear();
            loadTheme();
            loadCustomChips();
            loadUsageData();
            checkMonthlyReport(); // æ£€æŸ¥æœˆæŠ¥
            
            // é»˜è®¤è‡ªåŠ¨æ’åº (ç‚¹å‡»æœ€å°‘çš„æ’æœ€å‰)
            autoSortUnits();

            // æ¢å¤ä¸Šæ¬¡çš„é€‰æ‹©
            for (let i = 1; i <= 13; i++) {
                if(document.getElementById(`u${i}`)) {
                    restoreSelection(i, 1);
                    restoreSelection(i, 2);
                }
            }
        };

        // 2. ç´§æ€¥æ¨¡å¼
        function toggleEmergency() {
            const overlay = document.getElementById('emergencyOverlay');
            overlay.classList.toggle('active');
        }

        // 3. æ™ºèƒ½æ’åº (éšå½¢æ¨¡å¼ï¼šç‚¹å‡»æ¬¡æ•°å°‘çš„åœ¨å‰)
        function loadUsageData() {
            usageData = JSON.parse(localStorage.getItem('unit_usage') || "{}");
        }

        function autoSortUnits() {
            const container = document.getElementById('content-area');
            const cards = Array.from(container.getElementsByClassName('unit-card'));

            // æ’åºé€»è¾‘ï¼šç‚¹å‡»æ¬¡æ•°å°‘(usageDataå°) -> æ’åœ¨å‰é¢
            cards.sort((a, b) => {
                const idA = parseInt(a.id.replace('u', ''));
                const idB = parseInt(b.id.replace('u', ''));
                const usageA = usageData[idA] || 0;
                const usageB = usageData[idB] || 0;
                
                // å¦‚æœæ¬¡æ•°ä¸€æ ·ï¼ŒæŒ‰IDé»˜è®¤æ’åº
                if (usageA === usageB) return idA - idB;
                return usageA - usageB; 
            });

            cards.forEach(card => container.appendChild(card));
        }

        function incrementUsage(unitNum) {
            usageData[unitNum] = (usageData[unitNum] || 0) + 1;
            localStorage.setItem('unit_usage', JSON.stringify(usageData));
        }

        // 4. æœˆåº¦æŠ¥å‘Š (Heartwarming Report)
        function checkMonthlyReport() {
            const now = new Date();
            const currentMonth = `${now.getFullYear()}-${now.getMonth() + 1}`; // e.g. "2025-12"
            const storedMonth = localStorage.getItem('stats_last_month');
            
            // æ›´æ–°æ‰“å¼€æ¬¡æ•°
            let openCount = parseInt(localStorage.getItem('stats_open_count') || "0") + 1;
            localStorage.setItem('stats_open_count', openCount);

            // å¦‚æœæ˜¯æ–°çš„ä¸€æœˆï¼Œç»“ç®—ä¸Šä¸ªæœˆ
            if (storedMonth && storedMonth !== currentMonth) {
                showMonthlySummary(storedMonth);
                // é‡ç½®æ•°æ®
                localStorage.setItem('stats_open_count', 1); // æ–°æœˆç¬¬1æ¬¡
                // æ³¨æ„ï¼šusageData ä¸é‡ç½®ï¼Œå› ä¸ºé‚£æ˜¯ç´¯è®¡ç†Ÿç»ƒåº¦
            }
            
            localStorage.setItem('stats_last_month', currentMonth);
        }

        function showMonthlySummary(monthStr) {
            const openCount = localStorage.getItem('stats_open_count');
            
            // æ‰¾å‡ºæœ€å¸¸çœ‹å’Œæœ€å°‘çœ‹çš„
            let maxId = null, minId = null;
            let maxVal = -1, minVal = 999999;
            
            for(let i=1; i<=13; i++) {
                let val = usageData[i] || 0;
                if(val > maxVal) { maxVal = val; maxId = i; }
                if(val < minVal) { minVal = val; minId = i; }
            }

            let msg = `å˜¿ï¼è€æœ‹å‹ï¼Œ${monthStr.split('-')[1]}æœˆè¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ<br><br>`;
            msg += `è¿™ä¸ªæœˆä½ ä¸€å…±æ‰“å¼€äº†è¿™é‡Œ <b>${openCount}</b> æ¬¡ã€‚<br>`;
            
            if(openCount > 20) {
                msg += "ğŸ‰ å“‡ï¼ä½ ç®€ç›´æ˜¯è‹±è¯­ç‹‚é­”ï¼Œå¤ªæ£’äº†ï¼è¯·åŠ¡å¿…ä¿æŒè¿™ä¸ªèŠ‚å¥ï¼<br><br>";
            } else if (openCount > 5) {
                msg += "ğŸ‘ ä¸é”™å“¦ï¼Œä½ æ­£åœ¨ç¨³æ­¥å‰è¿›ï¼Œç»§ç»­åŠ æ²¹ï¼<br><br>";
            } else {
                msg += "ğŸ¥º å“å‘€ï¼Œå¥½ä¹…ä¸è§äº†ï¼Œä¸‹ä¸ªæœˆè¦å¤šæ¥çœ‹çœ‹æˆ‘å“¦~<br><br>";
            }

            // è·å–å¡ç‰‡åç§°
            const getName = (id) => {
                const el = document.getElementById(`u${id}`);
                return el ? el.getAttribute('data-name') : "æœªçŸ¥";
            };

            if(maxId) msg += `ğŸ”¥ æœ€å¸¸ç»ƒä¹ ï¼š<b>${getName(maxId)}</b> (${maxVal}æ¬¡)<br>`;
            if(minId) msg += `ğŸ§Š ç»ƒå¾—æœ€å°‘ï¼š<b>${getName(minId)}</b> (å¿«å»çœ‹çœ‹å§!)`;

            document.getElementById('reportContent').innerHTML = msg;
            document.getElementById('reportModal').style.display = 'flex';
        }

        // 5. éšæœºæŠ½æŸ¥
        function startRandomDrill() {
            const u = Math.floor(Math.random() * 13) + 1; 
            const unitCard = document.getElementById(`u${u}`);
            if(!unitCard) { startRandomDrill(); return; } 
            
            // ä¿®å¤ï¼šè·å–ä¸å«æ ‡ç­¾çš„çº¯æ–‡æœ¬
            const rawTitle = unitCard.querySelector('.unit-header').childNodes[0].textContent.trim();
            
            const modal = document.getElementById('randomModal');
            document.getElementById('modalQuestion').innerText = `${rawTitle}`;
            modal.style.display = 'flex';
            currentRandomUnit = u;
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function revealRandomAnswer() {
            closeModal('randomModal');
            const el = document.getElementById(`u${currentRandomUnit}`);
            if(el) {
                // ä¿®å¤å®šä½ä¸å‡†ï¼šæ‰‹åŠ¨è®¡ç®— Offset
                const headerOffset = 160;
                const elementPosition = el.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });

                // é—ªçƒä¸€ä¸‹æç¤º
                el.style.transform = 'scale(1.02)';
                el.style.border = '2px solid var(--primary)';
                setTimeout(() => {
                    el.style.transform = 'scale(1)';
                    el.style.border = '1px solid var(--border)';
                }, 600);
            }
        }

        // 6. åŸºç¡€åŠŸèƒ½ (Time, Theme, Search, Custom Chip)
        function updateTime() { document.getElementById('datetime').innerText = new Date().toLocaleString(); }
        
        function toggleTheme() {
            const html = document.documentElement;
            const newTheme = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }
        function loadTheme() {
            const saved = localStorage.getItem('theme');
            if(saved) document.documentElement.setAttribute('data-theme', saved);
        }

        function filterUnits() {
            const filter = document.getElementById('searchBox').value.toLowerCase();
            const cards = document.getElementsByClassName('unit-card');
            for(let card of cards) {
                const text = card.innerText.toLowerCase();
                const keys = card.getAttribute('data-keywords') || "";
                card.style.display = (text.includes(filter) || keys.includes(filter)) ? "" : "none";
            }
        }

        function addCustomChip(unitNum, stepNum, prefix, suffix) {
            const eng = prompt("è‹±æ–‡ (e.g. oat milk):"); if(!eng) return;
            const cn = prompt("ä¸­æ–‡ (e.g. ç‡•éº¦å¥¶):"); if(!cn) return;
            const chipData = { unitNum, stepNum, eng, cn, prefix, suffix };
            const key = `custom_chips_u${unitNum}_s${stepNum}`;
            let list = JSON.parse(localStorage.getItem(key) || "[]");
            list.push(chipData);
            localStorage.setItem(key, JSON.stringify(list));
            renderAndClickChip(chipData, true);
        }

        function loadCustomChips() {
            for(let u=1; u<=13; u++) {
                for(let s=1; s<=2; s++) {
                    const list = JSON.parse(localStorage.getItem(`custom_chips_u${u}_s${s}`) || "[]");
                    list.forEach(d => renderAndClickChip(d, false));
                }
            }
        }

        function renderAndClickChip(data, triggerClick) {
            const container = document.getElementById(`u${data.unitNum}-s${data.stepNum}-chips`);
            if(!container) return;
            const btn = document.createElement('div');
            btn.className = 'chip';
            btn.innerText = data.eng;
            btn.onclick = function() { updateUnit(data.unitNum, data.stepNum, data.eng, data.cn, data.prefix, data.suffix, this); };
            
            const wrapper = container.querySelector('.add-btn-wrapper');
            if(wrapper) container.insertBefore(btn, wrapper);
            else {
                const addBtn = container.querySelector('.add-chip-btn');
                if(addBtn) container.insertBefore(btn, addBtn);
                else container.appendChild(btn);
            }
            if(triggerClick) btn.click();
        }

        function toggleQuizMode() { document.body.classList.toggle('quiz-mode'); }

        // æ ¸å¿ƒæ›´æ–°
        function updateUnit(unitNum, stepNum, engWord, cnWord, prefixEng, suffixCn, element, playSound = true) {
            // è®¡æ•°
            incrementUsage(unitNum);

            const wordId = `u${unitNum}-s${stepNum}-word`;
            const displayEl = document.getElementById(wordId);
            if(displayEl) displayEl.innerText = engWord;
            
            let fullCn = "";
            // é€šç”¨é€»è¾‘ (å®Œæ•´ç‰ˆ)
            if (unitNum === 1 && stepNum === 1) fullCn = "å—¨ï¼Œæˆ‘æ˜¯" + cnWord + "ã€‚";
            else if (unitNum === 1 && stepNum === 2) fullCn = "æˆ‘ä½åœ¨" + cnWord + "ã€‚";
            else if (unitNum === 2 && stepNum === 1) fullCn = "æ‰“æ‰°ä¸€ä¸‹ï¼Œæˆ‘åœ¨æ‰¾" + cnWord + "ã€‚";
            else if (unitNum === 2 && stepNum === 2) fullCn = "èƒ½å‘Šè¯‰æˆ‘" + cnWord + suffixCn + "ï¼Ÿ";
            else if (unitNum === 3 && stepNum === 1) fullCn = "æˆ‘èƒ½å€Ÿç”¨ä¸€ä¸‹æ‚¨çš„" + cnWord + suffixCn + "ï¼Ÿ";
            else if (unitNum === 3 && stepNum === 2) fullCn = "çœŸçš„" + cnWord + "ã€‚";
            else if (unitNum === 4 && stepNum === 1) fullCn = "æˆ‘æƒ³è¦" + cnWord + "ã€‚";
            else if (unitNum === 4 && stepNum === 2) fullCn = "è¿™æ˜¯æˆ‘çš„" + cnWord + "ã€‚";
            else if (unitNum === 5 && stepNum === 1) fullCn = "ä½ ä»¬æ”¶" + cnWord + suffixCn + "ï¼Ÿ";
            else if (unitNum === 5 && stepNum === 2) fullCn = "æˆ‘è¿˜æƒ³è¦" + cnWord + "ã€‚";
            else if (unitNum === 6 && stepNum === 1) fullCn = "æˆ‘èƒ½è¦ä¸€ä¸ª" + cnWord + "å—ï¼Ÿ";
            else if (unitNum === 6 && stepNum === 2) fullCn = "è¦åšæˆ" + cnWord + "çš„ã€‚";
            else if (unitNum === 7 && stepNum === 1) fullCn = "è¿™" + cnWord + "å¤ªæ£’äº†ï¼";
            else if (unitNum === 7 && stepNum === 2) fullCn = "æˆ‘æ¥å¸®å¿™" + cnWord + "ã€‚";
            else if (unitNum === 8 && stepNum === 1) fullCn = "æˆ‘ä»¬å¥½ä¹…æ²¡" + cnWord + "äº†ã€‚";
            else if (unitNum === 8 && stepNum === 2) fullCn = "ä½ æœ€è¿‘" + cnWord + "ï¼Ÿ";
            else if (unitNum === 9 && stepNum === 1) fullCn = "æˆ‘è¦å»" + cnWord + "ã€‚";
            else if (unitNum === 9 && stepNum === 2) fullCn = "è¯·åœ¨" + cnWord + "æ”¾æˆ‘ä¸‹æ¥ã€‚";
            else if (unitNum === 10 && stepNum === 1) fullCn = cnWord + "äº†ï¼";
            else if (unitNum === 10 && stepNum === 2) fullCn = "æ‰“" + cnWord + "ï¼";
            else if (unitNum === 11 && stepNum === 1) fullCn = "æŠ±æ­‰ï¼Œæˆ‘æ²¡" + cnWord + "ã€‚";
            else if (unitNum === 11 && stepNum === 2) fullCn = "ä½ èƒ½" + cnWord + "å—ï¼Ÿ";
            else if (unitNum === 12 && stepNum === 1) fullCn = "æˆ‘æƒ³è¦" + cnWord + "ã€‚";
            else if (unitNum === 12 && stepNum === 2) fullCn = "å®ƒ" + cnWord + "ã€‚";
            else if (unitNum === 13 && stepNum === 1) fullCn = "æˆ‘æƒ³é¢„çº¦" + cnWord + "ã€‚";
            else if (unitNum === 13 && stepNum === 2) fullCn = cnWord + "æœ‰ç©ºå—ï¼Ÿ";
            else fullCn = cnWord + (suffixCn ? suffixCn : "ã€‚");

            const transEl = document.getElementById(`u${unitNum}-s${stepNum}-trans`);
            if(transEl) transEl.innerText = fullCn;

            let container = element.parentElement;
            if (container.classList.contains('add-btn-wrapper')) container = container.parentElement.parentElement; // fix for wrapper structure
            
            // Safe selector
            let chips = container.querySelectorAll('.chip');
            for(let chip of chips) chip.classList.remove('active');
            element.classList.add('active');

            localStorage.setItem(`u${unitNum}-s${stepNum}`, JSON.stringify({ engWord, cnWord, prefix: prefixEng, suffix: suffixCn }));
            if(playSound) speakDirect(engWord);
        }

        function restoreSelection(unitNum, stepNum) {
            const savedData = localStorage.getItem(`u${unitNum}-s${stepNum}`);
            if (savedData) {
                const data = JSON.parse(savedData);
                const container = document.getElementById(`u${unitNum}-s${stepNum}-chips`);
                if(container) {
                    const chips = container.querySelectorAll('.chip');
                    for(let chip of chips) {
                        if(chip.innerText === data.engWord) {
                            updateUnit(unitNum, stepNum, data.engWord, data.cnWord, data.prefix, data.suffix, chip, false);
                            break;
                        }
                    }
                }
            }
        }

        function speakWholeSentence(wordId, prefix, punctuation) {
            let word = document.getElementById(wordId).innerText;
            speakDirect(prefix + " " + word + punctuation);
        }

        function speakDirect(text) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.9; 
            window.speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>
