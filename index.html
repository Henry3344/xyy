<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Survival English Guide v26.1</title>
    <style>
        /* --- CSS å˜é‡ (ä¿æŒåŸæ ·) --- */
        :root {
            --bg-body: #f2f2f7;
            --bg-card: #ffffff;
            --text-main: #1c1c1e;
            --text-sub: #8e8e93;
            --primary: #007aff;
            --primary-light: #e5f1ff;
            --border: #c6c6c8;
            --chip-bg: #ffffff;
            --chip-border: #d1d1d6;
            --nav-bg: rgba(255,255,255,0.95);
            --shadow: rgba(0,0,0,0.08);
            --display-area: #f2f2f7;
            --danger: #ff3b30;
            --accent: #5856d6;
        }

        [data-theme="dark"] {
            --bg-body: #000000;
            --bg-card: #1c1c1e;
            --text-main: #ffffff;
            --text-sub: #aeaeb2;
            --primary: #0a84ff;
            --primary-light: #1c1c1e;
            --border: #38383a;
            --chip-bg: #2c2c2e;
            --chip-border: #3a3a3c;
            --nav-bg: rgba(28,28,30,0.95);
            --shadow: rgba(255,255,255,0.05);
            --display-area: #2c2c2e;
            --danger: #ff453a;
            --accent: #5e5ce6;
        }

        /* --- åŸºç¡€å¸ƒå±€ --- */
        html, body { height: 100%; overflow: hidden; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: var(--bg-body); 
            color: var(--text-main); 
            margin: 0; padding: 0;
            display: flex;
            flex-direction: column;
            transition: background 0.3s, color 0.3s; 
            -webkit-tap-highlight-color: transparent;
        }
        
        /* --- é¡¶éƒ¨æ§åˆ¶å° --- */
        .header-container { 
            flex: 0 0 auto;
            background: var(--nav-bg); 
            backdrop-filter: blur(15px); 
            z-index: 1000; 
            border-bottom: 1px solid var(--border); 
            box-shadow: 0 4px 15px var(--shadow); 
            padding-top: env(safe-area-inset-top);
        }
        
        .top-row { display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; max-width: 650px; margin: 0 auto; }
        .app-title { font-size: 1.1em; font-weight: 800; color: var(--text-main); margin: 0; }
        .header-actions { display: flex; gap: 12px; }
        .icon-btn { background: none; border: 1px solid var(--border); color: var(--text-main); width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 1em; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .icon-btn.danger { border-color: var(--danger); color: var(--danger); font-weight: bold; }
        
        .search-row { padding: 0 15px 8px 15px; max-width: 650px; margin: 0 auto; }
        .search-input { width: 100%; padding: 8px 12px; border-radius: 10px; border: 1px solid var(--border); background: var(--bg-body); color: var(--text-main); font-size: 0.95em; box-sizing: border-box; outline: none; transition: border 0.2s; }
        .search-input:focus { border-color: var(--primary); }

        .nav-scroll { display: flex; overflow-x: auto; padding: 0 15px 10px 15px; gap: 8px; max-width: 650px; margin: 0 auto; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
        .nav-scroll::-webkit-scrollbar { display: none; }
        .nav-btn { flex: 0 0 auto; background: var(--primary-light); color: var(--primary); border: 1px solid transparent; padding: 5px 10px; border-radius: 14px; font-weight: 600; font-size: 0.8em; text-decoration: none; transition: all 0.2s; white-space: nowrap; cursor: pointer; }
        [data-theme="dark"] .nav-btn { border-color: var(--border); }
        .nav-btn.active-nav { background: var(--primary); color: white; }

        /* --- ä¸»å†…å®¹åŒº --- */
        #content-area {
            flex: 1;
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
            scroll-snap-type: x mandatory; 
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            padding: 15px 7.5vw; 
            gap: 15px;
            align-items: flex-start;
        }
        #content-area::-webkit-scrollbar { display: none; }

        /* --- å•å…ƒå¡ç‰‡ --- */
        .unit-card { 
            flex: 0 0 85vw; 
            max-width: 500px;
            background: var(--bg-card); 
            border-radius: 20px; 
            padding: 20px; 
            box-shadow: 0 8px 30px var(--shadow); 
            border: 1px solid var(--border); 
            scroll-snap-align: center; 
            scroll-snap-stop: always;
            box-sizing: border-box;
            height: 98%; 
            max-height: 85vh; 
            overflow-y: auto; 
            overflow-x: hidden;
            position: relative;
            transition: transform 0.2s;
            padding-bottom: 60px; /* å¢åŠ åº•éƒ¨ç•™ç™½ç»™æç¤ºè¯­ */
        }
        .unit-card::-webkit-scrollbar { display: none; }

        .unit-header { font-size: 1.3em; font-weight: 800; color: var(--primary); margin-bottom: 15px; border-bottom: 2px solid var(--display-area); padding-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .sort-rank { font-size: 0.6em; color: var(--text-sub); font-weight: normal; opacity: 0.5; background: var(--display-area); padding: 2px 6px; border-radius: 4px; }

        /* --- æ­¥éª¤åŒºåŸŸ --- */
        .step-container { margin-bottom: 20px; width: 100%; }
        .step-label { font-size: 0.75em; color: var(--text-sub); font-weight: 700; margin-bottom: 6px; display: block; text-transform: uppercase; letter-spacing: 0.5px; }
        
        .pattern-box { 
            font-family: "Menlo", monospace; color: #d63031; background: #ffeaea; padding: 2px 6px; border-radius: 4px; font-size: 1em; margin-left: 5px; border: 1px solid #ffcccc; display: inline-block; margin-top: 4px; 
            white-space: normal; word-wrap: break-word; 
        }
        [data-theme="dark"] .pattern-box { background: #3e1a1a; border-color: #5c1e1e; color: #ff6b6b; }

        /* --- ä¸»å¥æ˜¾ç¤ºåŒº --- */
        .display-area { 
            background-color: var(--display-area); padding: 15px; border-radius: 12px; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; gap: 10px; transition: background 0.3s; border: 1px solid var(--border); 
            width: 100%; box-sizing: border-box; 
        }
        .text-content { flex-grow: 1; min-width: 0; }
        .english-sentence { 
            font-size: 1.25em; font-weight: 600; line-height: 1.3; color: var(--text-main); margin-bottom: 4px; 
            white-space: normal; word-wrap: break-word; 
        }
        .highlight { color: var(--primary); text-decoration: underline; text-decoration-thickness: 3px; text-underline-offset: 4px; cursor: pointer; }
        .translation { color: var(--text-sub); font-size: 0.9em; white-space: normal; }
        
        /* --- æŒ‰é’® --- */
        .btn-audio { flex-shrink: 0; background: var(--bg-card); border: 1px solid var(--border); border-radius: 50%; width: 40px; height: 40px; min-width: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.1em; box-shadow: 0 2px 5px var(--shadow); color: var(--primary); }
        .btn-audio:active { transform: scale(0.92); }
        
        /* --- è¯æ±‡ç‚¹å‡»åŒº --- */
        .chips-container { display: flex; flex-wrap: wrap; gap: 8px; width: 100%; }
        .chip { 
            background: var(--chip-bg); border: 1px solid var(--chip-border); 
            padding: 6px 12px; border-radius: 16px; 
            font-size: 0.9em; cursor: pointer; font-weight: 600; color: var(--text-main); 
            transition: all 0.2s; user-select: none; 
            max-width: 100%; white-space: normal; word-wrap: break-word; 
        }
        .chip:hover { transform: translateY(-1px); border-color: var(--primary); }
        .chip.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 2px 8px rgba(0,122,255,0.3); transform: scale(1.02); }
        
        /* --- åŠ å·æŒ‰é’®ä¸æ°”æ³¡ --- */
        .add-btn-wrapper { position: relative; display: inline-block; vertical-align: middle; }
        
        .add-chip-btn { border: 1px dashed var(--text-sub); color: var(--text-sub); background: transparent; padding: 6px 10px; border-radius: 16px; font-size: 0.9em; cursor: pointer; }
        
        /* ã€ä¿®æ”¹1ã€‘ æ°”æ³¡æç¤º (æ¢å¤çº¢è‰²ï¼Œä½ç½®åœ¨ä¸Šæ–¹) */
        .bubble-tip { 
            position: absolute; bottom: 115%; left: 50%; transform: translateX(-50%); 
            background: var(--danger); color: white; padding: 6px 10px; border-radius: 8px; 
            font-size: 0.75em; font-weight: bold; box-shadow: 0 4px 12px rgba(255, 59, 48, 0.4); 
            z-index: 100; white-space: nowrap;
            /* åŠ¨ç”»éƒ¨åˆ† */
            opacity: 1; transition: opacity 1.5s ease;
            pointer-events: none;
        }
        .bubble-tip::after { content: ''; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: var(--danger) transparent transparent transparent; }
        
        /* 15såæ·»åŠ è¿™ä¸ªç±»åæ¥éšè— */
        .bubble-tip.fade-out { opacity: 0; }

        /* --- åˆ†éš”çº¿ --- */
        .divider { height: 1px; background: var(--border); margin: 20px 0; border: none; }

        /* --- è¿æ‹›æ€»ç»“ --- */
        .combo-box { 
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); color: white; padding: 15px; border-radius: 16px; margin-top: 20px; position: relative; box-shadow: 0 8px 15px rgba(0,0,0,0.2); 
            width: 100%; box-sizing: border-box;
        }
        [data-theme="dark"] .combo-box { background: linear-gradient(135deg, #1c1c1e 0%, #2c2c2e 100%); border: 1px solid #38383a; }
        .combo-title { font-size: 0.8em; font-weight: bold; opacity: 0.8; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; color: #ecf0f1; }
        .combo-text { font-size: 1.1em; font-weight: 600; line-height: 1.4; padding-right: 45px; margin-bottom: 10px; transition: all 0.3s; white-space: normal; word-wrap: break-word; }
        .structure-box { background: rgba(255,255,255,0.1); padding: 8px; border-radius: 8px; font-size: 0.8em; color: #bdc3c7; border: 1px dashed rgba(255,255,255,0.3); transition: all 0.3s; white-space: normal; }
        .struct-tag { display: inline-block; background: #e67e22; color: white; padding: 1px 5px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; font-weight: bold; margin-bottom: 4px; }
        .struct-arrow { margin: 0 4px; color: #ecf0f1; }
        
        /* --- ã€ä¿®æ”¹2ã€‘ æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š æç¤º (åŠ äº†æ¨¡ç³ŠèƒŒæ™¯) --- */
        .scroll-hint {
            position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%);
            width: auto; padding: 8px 16px; border-radius: 30px;
            text-align: center; color: var(--primary); font-size: 0.8em; font-weight: 600;
            pointer-events: none; opacity: 0; transition: opacity 0.3s;
            animation: bounce-hint 2s infinite; z-index: 50;
            white-space: nowrap;
            /* æ¨¡ç³Šæ¯›ç»ç’ƒæ•ˆæœ */
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        [data-theme="dark"] .scroll-hint {
            background: rgba(44, 44, 46, 0.8);
            color: white;
        }

        .scroll-hint.visible { opacity: 1; }
        @keyframes bounce-hint { 
            0%, 20%, 50%, 80%, 100% {transform: translateX(-50%) translateY(0);} 
            40% {transform: translateX(-50%) translateY(-5px);} 
            60% {transform: translateX(-50%) translateY(-3px);} 
        }

        /* --- æ‚¬æµ®æ§åˆ¶ç»„ --- */
        .float-controls { position: fixed; bottom: 40px; right: 20px; display: flex; flex-direction: column; gap: 15px; z-index: 2000; align-items: flex-end; }
        .fab-quiz { background: var(--danger); color: white; padding: 8px 16px; border-radius: 30px; font-weight: bold; box-shadow: 0 4px 15px rgba(255, 59, 48, 0.4); cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 6px; border: none; font-size: 0.85em; }
        .fab-quiz:active { transform: scale(0.95); }
        .fab-random { background: var(--accent); color: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2em; box-shadow: 0 4px 15px rgba(88, 86, 214, 0.4); border: none; cursor: pointer; }
        .quiz-active-text, body.quiz-mode .quiz-default-text { display: none; }
        body.quiz-mode .quiz-active-text { display: inline; }
        body.quiz-mode .fab-quiz { background: #34c759; box-shadow: 0 4px 15px rgba(52, 199, 89, 0.4); }

        /* --- ç‰¹è®­æ¨¡å¼ --- */
        body.quiz-mode .english-sentence { color: transparent !important; text-shadow: 0 0 13px rgba(128,128,128,0.5); user-select: none; }
        body.quiz-mode .english-sentence:active { color: var(--text-main) !important; text-shadow: none; }
        body.quiz-mode .pattern-box { color: transparent !important; background-color: var(--border); border-color: var(--border); user-select: none; }
        body.quiz-mode .pattern-box:active { color: #d63031 !important; background-color: #ffeaea; }
        body.quiz-mode .combo-text { color: transparent !important; text-shadow: 0 0 10px rgba(255,255,255,0.4); user-select: none; background: rgba(255,255,255,0.1); border-radius: 4px; }
        body.quiz-mode .combo-text:active { color: white !important; text-shadow: none; background: none; }
        body.quiz-mode .structure-box { color: transparent !important; text-shadow: 0 0 8px rgba(255,255,255,0.5); user-select: none; }
        body.quiz-mode .structure-box * { opacity: 0; }
        body.quiz-mode .structure-box:active { color: #bdc3c7 !important; text-shadow: none; }
        body.quiz-mode .structure-box:active * { opacity: 1; }

        /* --- åº”æ€¥æ¨¡å¼ Overlay --- */
        .emergency-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 9999; display: none; flex-direction: column; padding: 20px; box-sizing: border-box; }
        .emergency-overlay.active { display: flex; }
        .emergency-close { position: absolute; top: 20px; right: 20px; color: white; font-size: 2em; cursor: pointer; padding: 10px; }
        .emergency-card { flex: 1; display: flex; align-items: center; justify-content: center; text-align: center; border-bottom: 1px solid #333; cursor: pointer; }
        .emergency-text { font-size: 2.2em; color: white; font-weight: bold; line-height: 1.2; text-transform: uppercase; margin-bottom: 10px; }
        .emergency-sub { font-size: 1.2em; color: #aaa; }

        /* --- å¼¹çª—é€šç”¨ --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 5000; display: none; align-items: center; justify-content: center; }
        .modal-card { background: var(--bg-card); width: 85%; max-width: 400px; padding: 25px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 1px solid var(--border); animation: popIn 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .modal-title { font-size: 1.2em; font-weight: bold; color: var(--text-sub); margin-bottom: 20px; text-transform: uppercase; }
        .modal-content-text { font-size: 1.2em; color: var(--text-main); margin-bottom: 30px; line-height: 1.5; }
        .modal-actions { display: flex; gap: 10px; justify-content: center; }
        .modal-btn { padding: 8px 16px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; font-size: 1em; }
        .btn-reveal { background: var(--primary); color: white; }
        .btn-close { background: var(--border); color: var(--text-main); }
        
        .fixed-footer { 
            flex: 0 0 auto;
            text-align: center; color: var(--text-sub); font-size: 0.6em; 
            padding: 3px 0; 
            border-top: 1px solid var(--border); 
            background: var(--bg-body);
            opacity: 0.5;
        }
    </style>
</head>
<body>

    <div class="header-container" id="mainHeader">
        <div class="top-row">
            <div class="app-title">ğŸ‡ºğŸ‡¸ Survival English Guide</div>
            <div class="header-actions">
                <button class="icon-btn danger" onclick="toggleEmergency()" title="åº”æ€¥æ¨¡å¼">âš¡</button>
                <button class="icon-btn" onclick="toggleTheme()" title="åˆ‡æ¢æ¨¡å¼">ğŸŒ—</button>
            </div>
        </div>
        
        <div class="search-row">
            <input type="text" class="search-input" id="searchBox" placeholder="ğŸ” æœç´¢åœºæ™¯ (å¦‚: é€€è´§, coffee...)" onkeyup="filterUnits()">
        </div>

        <div class="nav-scroll">
            <a onclick="scrollToUnit('u1')" class="nav-btn">é‚»å±…</a>
            <a onclick="scrollToUnit('u2')" class="nav-btn">ä½ç½®</a>
            <a onclick="scrollToUnit('u3')" class="nav-btn">æ´—æ‰‹é—´</a>
            <a onclick="scrollToUnit('u4')" class="nav-btn">é“¶è¡Œ</a>
            <a onclick="scrollToUnit('u5')" class="nav-btn">ç»“è´¦</a>
            <a onclick="scrollToUnit('u6')" class="nav-btn">ç‚¹é¤</a>
            <a onclick="scrollToUnit('u7')" class="nav-btn">èšé¤</a>
            <a onclick="scrollToUnit('u8')" class="nav-btn">å™æ—§</a>
            <a onclick="scrollToUnit('u9')" class="nav-btn">æ‰“è½¦</a>
            <a onclick="scrollToUnit('u10')" class="nav-btn">æ€¥æ•‘</a>
            <a onclick="scrollToUnit('u11')" class="nav-btn">æ²¡å¬æ‡‚</a>
            <a onclick="scrollToUnit('u12')" class="nav-btn">é€€è´§</a>
            <a onclick="scrollToUnit('u13')" class="nav-btn">é¢„çº¦</a>
        </div>
    </div>

    <div class="emergency-overlay" id="emergencyOverlay">
        <div class="emergency-close" onclick="toggleEmergency()">âœ•</div>
        <div class="emergency-card" onclick="speakDirect('I need help! Please call 911.')">
            <div>
                <div class="emergency-text" style="color: #ff3b30;">I NEED HELP!<br>CALL 911</div>
                <div class="emergency-sub">æ•‘å‘½ï¼è¯·æ‰“911</div>
            </div>
        </div>
        <div class="emergency-card" onclick="speakDirect('I do not speak English. Please use a translation app.')">
            <div>
                <div class="emergency-text">I DON'T SPEAK ENGLISH</div>
                <div class="emergency-sub">æˆ‘ä¸ä¼šè‹±è¯­ (è¯·ç”¨ç¿»è¯‘è½¯ä»¶)</div>
            </div>
        </div>
        <div class="emergency-card" onclick="speakDirect('I am lost. Can you help me?')">
            <div>
                <div class="emergency-text">I AM LOST<br>CAN YOU HELP?</div>
                <div class="emergency-sub">æˆ‘è¿·è·¯äº†ï¼Œèƒ½å¸®æˆ‘å—ï¼Ÿ</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="randomModal">
        <div class="modal-card">
            <div class="modal-title">ğŸ² éšæœºåœºæ™¯æŒ‘æˆ˜</div>
            <div class="modal-content-text" id="modalQuestion" style="font-weight:bold; font-size: 1.4em;">...</div>
            <div class="modal-actions">
                <button class="modal-btn btn-close" onclick="closeModal('randomModal')">å…³é—­</button>
                <button class="modal-btn btn-reveal" onclick="revealRandomAnswer()">æŸ¥çœ‹ç­”æ¡ˆ</button>
            </div>
        </div>
    </div>

    <div id="content-area">
        </div>

    <div class="float-controls">
        <button class="fab-quiz" onclick="toggleQuizMode()">
            <span class="quiz-default-text">ğŸ‘“ é®ç›–æ¨¡å¼</span>
            <span class="quiz-active-text">ğŸ‘€ é€€å‡ºé®ç›–</span>
        </button>
        <button class="fab-random" onclick="showRandomCard()">ğŸ²</button>
    </div>

    <script>
        // --- æ ¸å¿ƒæ•°æ® (å…¨é¢æ‰©å……) ---
        const units = [
            {
                id: 'u1', title: 'Neighbor / Help', titleCn: 'é‚»é‡Œ/æ±‚åŠ©',
                pattern: 'Can I borrow [item]?',
                chips: [
                    {en: 'your ladder', cn: 'ä½ çš„æ¢¯å­'},
                    {en: 'some salt', cn: 'ä¸€äº›ç›'},
                    {en: 'a screwdriver', cn: 'èºä¸åˆ€'},
                    {en: 'your wifi', cn: 'ä½ çš„WiFi'},
                    {en: 'a plunger', cn: 'é©¬æ¡¶æ‹å­'},
                    {en: 'some ice', cn: 'ä¸€äº›å†°å—'},
                    {en: 'a vacuum', cn: 'å¸å°˜å™¨'},
                    {en: 'a hammer', cn: 'é”¤å­'}
                ],
                combos: [
                    { en: "Can you keep the noise down?", cn: "èƒ½å°å£°ç‚¹å—ï¼Ÿ" },
                    { en: "Is this package yours?", cn: "è¿™åŒ…è£¹æ˜¯ä½ çš„å—ï¼Ÿ" },
                    { en: "Please don't park here.", cn: "è¯·åˆ«åœè¿™å„¿ã€‚" },
                    { en: "Can you help me lift this?", cn: "èƒ½å¸®æˆ‘æŠ¬ä¸€ä¸‹å—ï¼Ÿ" },
                    { en: "I'm locked out.", cn: "æˆ‘è¢«é”å¤–é¢äº†ã€‚" },
                    { en: "When is trash day?", cn: "å“ªå¤©å€’åƒåœ¾ï¼Ÿ" }
                ]
            },
            {
                id: 'u2', title: 'Location', titleCn: 'é—®è·¯/ä½ç½®',
                pattern: 'Is [place] near here?',
                chips: [
                    {en: 'the subway', cn: 'åœ°é“ç«™'},
                    {en: 'a pharmacy', cn: 'è¯æˆ¿'},
                    {en: 'Main Street', cn: 'ä¸»è¡—'},
                    {en: 'the bus stop', cn: 'å…¬äº¤ç«™'},
                    {en: 'a post office', cn: 'é‚®å±€'},
                    {en: 'a gas station', cn: 'åŠ æ²¹ç«™'},
                    {en: 'a laundromat', cn: 'æ´—è¡£æˆ¿'},
                    {en: 'a grocery store', cn: 'æ‚è´§åº—'}
                ],
                combos: [
                    { en: "It is within walking distance.", cn: "èµ°è·¯èƒ½åˆ°ã€‚" },
                    { en: "You can take the Q13 bus.", cn: "ä½ å¯ä»¥åQ13å…¬äº¤ã€‚" },
                    { en: "It is on the corner.", cn: "å°±åœ¨æ‹è§’å¤„ã€‚" },
                    { en: "Can you show me on Google Maps?", cn: "èƒ½åœ¨åœ°å›¾ä¸ŠæŒ‡ä¸€ä¸‹å—ï¼Ÿ" },
                    { en: "Go straight and turn left.", cn: "ç›´èµ°ç„¶åå·¦è½¬ã€‚" },
                    { en: "It is across the street.", cn: "å°±åœ¨è¡—å¯¹é¢ã€‚" }
                ]
            },
            {
                id: 'u3', title: 'Restroom', titleCn: 'æ´—æ‰‹é—´',
                pattern: 'What is the [noun]?',
                chips: [
                    {en: 'restroom code', cn: 'å•æ‰€å¯†ç '},
                    {en: 'wifi password', cn: 'WiFiå¯†ç '},
                    {en: 'door code', cn: 'é—¨ç¦å¯†ç '},
                    {en: 'total price', cn: 'æ€»ä»·'},
                    {en: 'gate number', cn: 'ç™»æœºå£å·'},
                    {en: 'room number', cn: 'æˆ¿é—´å·'}
                ],
                combos: [
                    { en: "Is the restroom open?", cn: "å•æ‰€å¼€ç€å—ï¼Ÿ" },
                    { en: "Where can I wash my hands?", cn: "å“ªèƒ½æ´—æ‰‹ï¼Ÿ" },
                    { en: "Do I need a key?", cn: "éœ€è¦é’¥åŒ™å—ï¼Ÿ" },
                    { en: "It is for customers only.", cn: "ä»…é™é¡¾å®¢ä½¿ç”¨ã€‚" },
                    { en: "Someone is inside.", cn: "é‡Œé¢æœ‰äººã€‚" },
                    { en: "The toilet is clogged.", cn: "é©¬æ¡¶å µäº†ã€‚" }
                ]
            },
            {
                id: 'u4', title: 'Bank', titleCn: 'é“¶è¡Œ',
                pattern: 'I want to [verb] money.',
                chips: [
                    {en: 'deposit', cn: 'å­˜'},
                    {en: 'withdraw', cn: 'å–'},
                    {en: 'exchange', cn: 'æ¢æ±‡'},
                    {en: 'transfer', cn: 'è½¬è´¦'},
                    {en: 'save', cn: 'å­˜(å®šæœŸ)'},
                    {en: 'wire', cn: 'ç”µæ±‡'}
                ],
                combos: [
                    { en: "I need to open an account.", cn: "æˆ‘è¦å¼€æˆ·ã€‚" },
                    { en: "What is the exchange rate?", cn: "æ±‡ç‡æ˜¯å¤šå°‘ï¼Ÿ" },
                    { en: "I lost my debit card.", cn: "æˆ‘å€Ÿè®°å¡ä¸¢äº†ã€‚" },
                    { en: "Can I get a notary here?", cn: "è¿™é‡Œèƒ½å…¬è¯å—ï¼Ÿ" },
                    { en: "I need small bills.", cn: "æˆ‘è¦å°é¢é¢é’ç¥¨ã€‚" },
                    { en: "I forgot my PIN.", cn: "æˆ‘å¿˜å¯†ç äº†ã€‚" }
                ]
            },
            {
                id: 'u5', title: 'Checkout', titleCn: 'è¶…å¸‚ç»“è´¦',
                pattern: 'I will pay by [method].',
                chips: [
                    {en: 'credit card', cn: 'ä¿¡ç”¨å¡'},
                    {en: 'cash', cn: 'ç°é‡‘'},
                    {en: 'Apple Pay', cn: 'è‹¹æœæ”¯ä»˜'},
                    {en: 'debit card', cn: 'å€Ÿè®°å¡'},
                    {en: 'gift card', cn: 'ç¤¼å“å¡'},
                    {en: 'QR code', cn: 'äºŒç»´ç '}
                ],
                combos: [
                    { en: "Receipt in the bag, please.", cn: "æ”¶æ®æ”¾è¢‹å­é‡Œã€‚" },
                    { en: "Do you need a bag?", cn: "è¦è¢‹å­å—ï¼Ÿ" },
                    { en: "I have a coupon.", cn: "æˆ‘æœ‰ä¼˜æƒ åˆ¸ã€‚" },
                    { en: "Keep the change.", cn: "ä¸ç”¨æ‰¾é›¶äº†ã€‚" },
                    { en: "This price is wrong.", cn: "è¿™ä»·æ ¼ä¸å¯¹ã€‚" },
                    { en: "Can you double bag it?", cn: "èƒ½å¥—ä¸¤ä¸ªè¢‹å­å—ï¼Ÿ" }
                ]
            },
            {
                id: 'u6', title: 'Ordering', titleCn: 'ç‚¹é¤',
                pattern: 'Can I get [item]?',
                chips: [
                    {en: 'no ice', cn: 'å»å†°'},
                    {en: 'less sugar', cn: 'å°‘ç³–'},
                    {en: 'sauce on the side', cn: 'é…±æ–™å•æ”¾'},
                    {en: 'extra napkins', cn: 'å¤šç‚¹çº¸å·¾'},
                    {en: 'a fork', cn: 'ä¸€ä¸ªå‰å­'},
                    {en: 'the check', cn: 'ä¹°å•'},
                    {en: 'some water', cn: 'ä¸€äº›æ°´'}
                ],
                combos: [
                    { en: "For here or to go?", cn: "åœ¨è¿™åƒè¿˜æ˜¯å¸¦èµ°ï¼Ÿ" },
                    { en: "I'll have the combo.", cn: "æˆ‘è¦å¥—é¤ã€‚" },
                    { en: "What do you recommend?", cn: "æœ‰ä»€ä¹ˆæ¨èï¼Ÿ" },
                    { en: "I am allergic to peanuts.", cn: "æˆ‘å¯¹èŠ±ç”Ÿè¿‡æ•ã€‚" },
                    { en: "Just water, please.", cn: "åªè¦æ°´ã€‚" },
                    { en: "Can we split the check?", cn: "èƒ½åˆ†å¼€ä»˜å—ï¼Ÿ" }
                ]
            },
            {
                id: 'u7', title: 'Hanging Out', titleCn: 'æœ‹å‹èšé¤',
                pattern: 'Let\'s [action].',
                chips: [
                    {en: 'split the bill', cn: 'AAåˆ¶'},
                    {en: 'grab a drink', cn: 'å–ä¸€æ¯'},
                    {en: 'go to KTV', cn: 'å»å”±K'},
                    {en: 'take a photo', cn: 'æ‹å¼ ç…§'},
                    {en: 'order pizza', cn: 'ç‚¹æŠ«è¨'},
                    {en: 'watch a movie', cn: 'çœ‹ç”µå½±'}
                ],
                combos: [
                    { en: "It's my treat today.", cn: "ä»Šå¤©æˆ‘è¯·å®¢ã€‚" },
                    { en: "Are you free this weekend?", cn: "å‘¨æœ«æœ‰ç©ºå—ï¼Ÿ" },
                    { en: "Let's meet at 7.", cn: "å’±ä»¬7ç‚¹è§ã€‚" },
                    { en: "I'm running a bit late.", cn: "æˆ‘è¦è¿Ÿåˆ°ä¸€ç‚¹ã€‚" },
                    { en: "Next time is on me.", cn: "ä¸‹æ¬¡æˆ‘è¯·ã€‚" },
                    { en: "I'll pick you up.", cn: "æˆ‘å»æ¥ä½ ã€‚" }
                ]
            },
            {
                id: 'u8', title: 'Catch Up', titleCn: 'å™æ—§',
                pattern: 'How is your [noun]?',
                chips: [
                    {en: 'job', cn: 'å·¥ä½œ'},
                    {en: 'family', cn: 'å®¶äºº'},
                    {en: 'new apartment', cn: 'æ–°å…¬å¯“'},
                    {en: 'boyfriend', cn: 'ç”·æœ‹å‹'},
                    {en: 'trip', cn: 'æ—…è¡Œ'},
                    {en: 'health', cn: 'èº«ä½“'}
                ],
                combos: [
                    { en: "Long time no see!", cn: "å¥½ä¹…ä¸è§ï¼" },
                    { en: "You haven't changed a bit.", cn: "ä½ ä¸€ç‚¹æ²¡å˜ã€‚" },
                    { en: "We should do this again.", cn: "å’±ä»¬å¾—å†èšã€‚" },
                    { en: "I missed you so much.", cn: "æˆ‘å¾ˆæƒ³ä½ ã€‚" },
                    { en: "What have you been up to?", cn: "æœ€è¿‘å¿™å•¥å‘¢ï¼Ÿ" },
                    { en: "Let's keep in touch.", cn: "ä¿æŒè”ç³»ã€‚" }
                ]
            },
            {
                id: 'u9', title: 'Taxi / Uber', titleCn: 'æ‰“è½¦',
                pattern: 'Please [action].',
                chips: [
                    {en: 'turn left', cn: 'å·¦è½¬'},
                    {en: 'pull over', cn: 'é è¾¹åœè½¦'},
                    {en: 'drive slower', cn: 'å¼€æ…¢ç‚¹'},
                    {en: 'turn on AC', cn: 'å¼€ç©ºè°ƒ'},
                    {en: 'open the trunk', cn: 'å¼€åå¤‡ç®±'},
                    {en: 'wait here', cn: 'åœ¨è¿™ç­‰'},
                    {en: 'roll down the window', cn: 'æ‘‡ä¸‹çª—æˆ·'}
                ],
                combos: [
                    { en: "I am in a hurry.", cn: "æˆ‘èµ¶æ—¶é—´ã€‚" },
                    { en: "How long to get there?", cn: "å¤šä¹…èƒ½åˆ°ï¼Ÿ" },
                    { en: "This is the wrong way.", cn: "èµ°é”™è·¯äº†å§ã€‚" },
                    { en: "Drop me off here.", cn: "è¿™å„¿ä¸‹è½¦ã€‚" },
                    { en: "Keep the meter running.", cn: "æ‰“ç€è¡¨ç­‰æˆ‘ã€‚" },
                    { en: "Can I charge my phone?", cn: "èƒ½å……ä¸‹ç”µå—ï¼Ÿ" }
                ]
            },
            {
                id: 'u10', title: 'Emergency', titleCn: 'æ€¥æ•‘/åŒ»ç–—',
                pattern: 'I have [symptom].',
                chips: [
                    {en: 'a fever', cn: 'å‘çƒ§'},
                    {en: 'a stomachache', cn: 'èƒƒç–¼'},
                    {en: 'high blood pressure', cn: 'é«˜è¡€å‹'},
                    {en: 'an allergy', cn: 'è¿‡æ•'},
                    {en: 'chest pain', cn: 'èƒ¸ç—›'},
                    {en: 'a cut', cn: 'å‰²ä¼¤'},
                    {en: 'a rash', cn: 'çš®ç–¹'}
                ],
                combos: [
                    { en: "Call an ambulance!", cn: "å«æ•‘æŠ¤è½¦ï¼" },
                    { en: "Where is the hospital?", cn: "åŒ»é™¢åœ¨å“ªï¼Ÿ" },
                    { en: "I need a doctor.", cn: "æˆ‘éœ€è¦åŒ»ç”Ÿã€‚" },
                    { en: "I am bleeding.", cn: "æˆ‘æµè¡€äº†ã€‚" },
                    { en: "He passed out.", cn: "ä»–æ™•å€’äº†ã€‚" },
                    { en: "I have insurance.", cn: "æˆ‘æœ‰ä¿é™©ã€‚" }
                ]
            },
            {
                id: 'u11', title: 'Confusion', titleCn: 'æ²¡å¬æ‡‚',
                pattern: 'Can you [action]?',
                chips: [
                    {en: 'speak slowly', cn: 'è¯´æ…¢ç‚¹'},
                    {en: 'say that again', cn: 'å†è¯´ä¸€é'},
                    {en: 'write it down', cn: 'å†™ä¸‹æ¥'},
                    {en: 'use simple words', cn: 'ç”¨ç®€å•çš„è¯'},
                    {en: 'show me', cn: 'æŒ‡ç»™æˆ‘çœ‹'},
                    {en: 'translate it', cn: 'ç¿»è¯‘ä¸€ä¸‹'}
                ],
                combos: [
                    { en: "I don't understand.", cn: "æˆ‘ä¸æ˜ç™½ã€‚" },
                    { en: "My English is not good.", cn: "æˆ‘è‹±è¯­ä¸å¥½ã€‚" },
                    { en: "What does that mean?", cn: "é‚£æ˜¯å•¥æ„æ€ï¼Ÿ" },
                    { en: "Please be patient.", cn: "è¯·è€å¿ƒç‚¹ã€‚" },
                    { en: "Use Google Translate.", cn: "ç”¨è°·æ­Œç¿»è¯‘ã€‚" },
                    { en: "Sorry, I am lost.", cn: "æŠ±æ­‰ï¼Œæˆ‘å¬æ‡µäº†ã€‚" }
                ]
            },
            {
                id: 'u12', title: 'Returns', titleCn: 'é€€è´§/å”®å',
                pattern: 'I want to return this. It is [reason].',
                chips: [
                    {en: 'broken', cn: 'åçš„'},
                    {en: 'wrong size', cn: 'å°ºç ä¸å¯¹'},
                    {en: 'expired', cn: 'è¿‡æœŸçš„'},
                    {en: 'used', cn: 'æ—§çš„/ç”¨è¿‡çš„'},
                    {en: 'not what I ordered', cn: 'å‘é”™è´§äº†'},
                    {en: 'defective', cn: 'æœ‰ç¼ºé™·'},
                    {en: 'stained', cn: 'æœ‰æ±¡æ¸'}
                ],
                combos: [
                    { en: "I have the receipt.", cn: "æˆ‘æœ‰æ”¶æ®ã€‚" },
                    { en: "Can I get a refund?", cn: "èƒ½é€€æ¬¾å—ï¼Ÿ" },
                    { en: "I just changed my mind.", cn: "æˆ‘ä¸æƒ³è¦äº†ã€‚" },
                    { en: "Store credit is okay.", cn: "é€€åˆ°ä½™é¢ä¹Ÿè¡Œã€‚" },
                    { en: "I want to speak to a manager.", cn: "æˆ‘è¦è§ç»ç†ã€‚" },
                    { en: "Can I exchange this?", cn: "èƒ½æ¢è´§å—ï¼Ÿ" }
                ]
            },
            {
                id: 'u13', title: 'Reservation', titleCn: 'é¢„çº¦',
                pattern: 'I want to [action] my appointment.',
                chips: [
                    {en: 'cancel', cn: 'å–æ¶ˆ'},
                    {en: 'change', cn: 'æ›´æ”¹'},
                    {en: 'confirm', cn: 'ç¡®è®¤'},
                    {en: 'reschedule', cn: 'æ”¹æœŸ'},
                    {en: 'make', cn: 'é¢„çº¦'},
                    {en: 'check', cn: 'æŸ¥è¯¢'}
                ],
                combos: [
                    { en: "I have a reservation at 6.", cn: "æˆ‘æœ‰6ç‚¹çš„é¢„çº¦ã€‚" },
                    { en: "Table for two, please.", cn: "ä¸¤ä½ã€‚" },
                    { en: "Is there a wait?", cn: "è¦æ’é˜Ÿå—ï¼Ÿ" },
                    { en: "Under the name Henry.", cn: "åå­—æ˜¯Henryã€‚" },
                    { en: "We are running late.", cn: "æˆ‘ä»¬ä¼šæ™šç‚¹åˆ°ã€‚" },
                    { en: "Do you accept walk-ins?", cn: "æ²¡é¢„çº¦èƒ½è¿›å—ï¼Ÿ" }
                ]
            }
        ];

        // --- åˆå§‹åŒ–ä¸æ¸²æŸ“ ---
        const contentArea = document.getElementById('content-area');

        function renderUnits() {
            contentArea.innerHTML = '';
            units.forEach((unit, index) => {
                const card = document.createElement('div');
                card.className = 'unit-card';
                card.id = unit.id;
                
                // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª chip
                const firstChip = unit.chips[0];
                const cleanPattern = unit.pattern.replace(/\[.*?\]/, '<span class="pattern-slot">' + firstChip.en + '</span>');
                
                let chipsHtml = unit.chips.map((c, i) => 
                    `<div class="chip ${i===0?'active':''}" onclick="selectChip(this, '${unit.id}', '${c.en}', '${c.cn}')">${c.en}</div>`
                ).join('');

                // ã€ä¿®æ”¹3ã€‘ æ¸²æŸ“æ—¶æŠŠçº¢è‰²æ°”æ³¡åŠ è¿›å»
                chipsHtml += `
                    <div class="add-btn-wrapper">
                        <div class="bubble-tip">ç‚¹è¿™åŠ è¯ï¼</div>
                        <button class="add-chip-btn" onclick="addChip('${unit.id}')">+ Add</button>
                    </div>
                `;

                // è¿æ‹›éƒ¨åˆ† HTML
                let combosHtml = unit.combos.map(combo => 
                    `<div class="combo-text" onclick="speak('${combo.en}')">${combo.en} <span style="font-size:0.8em; opacity:0.7; font-weight:normal">(${combo.cn})</span></div>`
                ).join('');

                // åº•éƒ¨æ»‘åŠ¨æç¤º (ä»…ç¬¬ä¸€ä¸ªå¡ç‰‡æ˜¾ç¤º)
                const scrollHint = index === 0 ? `<div class="scroll-hint visible">â¬‡ï¸ å‘ä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤šè¿æ‹›</div>` : '';

                card.innerHTML = `
                    <div class="unit-header">
                        <span>${unit.title} <span style="font-size:0.6em; font-weight:normal;">${unit.titleCn}</span></span>
                        <span class="sort-rank">#${index + 1}</span>
                    </div>

                    <div class="step-container">
                        <span class="step-label">Step 1: æ ¸å¿ƒå¥å‹ (æ›¿æ¢å•è¯)</span>
                        <div class="display-area">
                            <div class="text-content">
                                <div class="english-sentence" id="sent-${unit.id}">${cleanPattern}</div>
                                <div class="translation" id="trans-${unit.id}">${firstChip.cn}</div>
                            </div>
                            <button class="btn-audio" onclick="speakCurrent('${unit.id}')">ğŸ”Š</button>
                        </div>
                        <div class="chips-container" id="chips-${unit.id}">
                            ${chipsHtml}
                        </div>
                    </div>

                    <div class="divider"></div>

                    <div class="step-container">
                        <span class="step-label">Step 2: é«˜é¢‘è¿æ‹› (ç›´æ¥ç”¨)</span>
                        <div class="combo-box">
                            <div class="combo-title">Native Speakers Say:</div>
                            ${combosHtml}
                            <div class="structure-box">
                                <span class="struct-tag">Structure</span>
                                ğŸ’¡ ç‚¹å‡»å¥å­ç›´æ¥å‘éŸ³ï¼Œæ¨¡ä»¿è¯­è°ƒã€‚
                            </div>
                        </div>
                    </div>
                    ${scrollHint}
                `;
                contentArea.appendChild(card);
            });
            
            // ã€ä¿®æ”¹4ã€‘ 15ç§’åè®©æ°”æ³¡æ…¢æ…¢æ¶ˆå¤±
            setTimeout(() => {
                document.querySelectorAll('.bubble-tip').forEach(el => el.classList.add('fade-out'));
            }, 15000);
        }

        // --- äº¤äº’é€»è¾‘ ---
        function selectChip(el, unitId, enText, cnText) {
            // æ›´æ–° UI çŠ¶æ€
            document.querySelectorAll(`#chips-${unitId} .chip`).forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            
            // æ›´æ–°å¥å­
            const unit = units.find(u => u.id === unitId);
            const sentEl = document.getElementById(`sent-${unitId}`);
            const transEl = document.getElementById(`trans-${unitId}`);
            
            // ç®€å•çš„æ­£åˆ™æ›¿æ¢ï¼Œä¿ç•™å¥å‹ç»“æ„
            const parts = unit.pattern.split(/\[.*?\]/);
            if(parts.length > 1) {
                sentEl.innerHTML = parts[0] + `<span class="pattern-slot" style="color:var(--primary); text-decoration:underline;">${enText}</span>` + parts[1];
            } else {
                sentEl.innerText = enText; // Fallback
            }
            transEl.innerText = cnText;
        }

        function speakCurrent(unitId) {
            const text = document.getElementById(`sent-${unitId}`).innerText;
            speak(text);
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.rate = 0.9;
            window.speechSynthesis.speak(utterance);
        }
        
        function speakDirect(text) {
             window.speechSynthesis.cancel();
             const msg = new SpeechSynthesisUtterance(text);
             msg.lang = 'en-US';
             window.speechSynthesis.speak(msg);
        }

        function scrollToUnit(id) {
            document.getElementById(id).scrollIntoView({behavior: 'smooth', block: 'center'});
            // æ›´æ–°å¯¼èˆªæ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-nav'));
            event.target.classList.add('active-nav');
        }
        
        function filterUnits() {
            const term = document.getElementById('searchBox').value.toLowerCase();
            units.forEach(u => {
                const card = document.getElementById(u.id);
                // æœç´¢ æ ‡é¢˜ã€ä¸­æ–‡æ ‡é¢˜ã€Chipså†…å®¹
                const match = u.title.toLowerCase().includes(term) || 
                              u.titleCn.includes(term) || 
                              u.chips.some(c => c.en.toLowerCase().includes(term) || c.cn.includes(term));
                card.style.display = match ? 'block' : 'none';
            });
        }

        function addChip(unitId) {
            const en = prompt("è¾“å…¥è‹±æ–‡å•è¯/çŸ­è¯­ (ä¾‹å¦‚: extra rice)");
            if(!en) return;
            const cn = prompt("è¾“å…¥ä¸­æ–‡å«ä¹‰ (ä¾‹å¦‚: å¤šç‚¹é¥­)");
            if(!cn) return;
            
            const unit = units.find(u => u.id === unitId);
            unit.chips.push({en, cn});
            
            // é‡æ–°æ¸²æŸ“è¯¥å¡ç‰‡çš„ chips åŒºåŸŸ
            const container = document.getElementById(`chips-${unitId}`);
            // åˆ›å»ºæ–° chip DOM
            const newChip = document.createElement('div');
            newChip.className = 'chip';
            newChip.innerText = en;
            newChip.onclick = function() { selectChip(this, unitId, en, cn) };
            
            // æ’å…¥åˆ° "Add" æŒ‰é’®ä¹‹å‰
            const btnWrapper = container.querySelector('.add-btn-wrapper');
            container.insertBefore(newChip, btnWrapper);
            
            // è‡ªåŠ¨é€‰ä¸­
            selectChip(newChip, unitId, en, cn);
        }

        // --- æ¨¡å¼åˆ‡æ¢ ---
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            html.setAttribute('data-theme', current === 'dark' ? 'light' : 'dark');
        }

        function toggleEmergency() {
            const overlay = document.getElementById('emergencyOverlay');
            overlay.classList.toggle('active');
        }

        function toggleQuizMode() {
            document.body.classList.toggle('quiz-mode');
        }
        
        // --- éšæœºæŠ½æŸ¥ ---
        let currentRandomAnswer = "";
        function showRandomCard() {
            const allSentences = [];
            units.forEach(u => {
                u.combos.forEach(c => allSentences.push({en: c.en, cn: c.cn, type: 'combo'}));
                u.chips.forEach(c => allSentences.push({en: u.pattern.replace(/\[.*?\]/, c.en), cn: `(åœºæ™¯: ${u.titleCn}) ${c.cn}`, type: 'pattern'}));
            });
            
            const randomItem = allSentences[Math.floor(Math.random() * allSentences.length)];
            currentRandomAnswer = randomItem.en;
            
            document.getElementById('modalQuestion').innerText = randomItem.cn;
            document.getElementById('randomModal').style.display = 'flex';
        }
        
        function revealRandomAnswer() {
            const el = document.getElementById('modalQuestion');
            el.innerText = currentRandomAnswer;
            el.style.color = "var(--primary)";
            speak(currentRandomAnswer);
        }
        
        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        // --- é¡µé¢åŠ è½½ ---
        window.onload = function() {
            renderUnits();
        };

    </script>
</body>
</html>
